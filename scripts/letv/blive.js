"use strict";function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t,e){function i(t){for(var e=0;e<v.rows.length;e++){var i=v.rows[e];if(t==i.code)return i.name}}function o(t){var e={yuanhua:"99","4k":"28","1080p":"25","720p":"22",1300:"19",1e3:"16",800:"13",350:"10"};return e.hasOwnProperty(t)?e[t]:t}function s(t){var e={10:"350",13:"800",16:"1000",19:"1300",22:"720p",25:"1080p",28:"4k",99:"yuanhua"};return e.hasOwnProperty(t)?e[t]:t}if("undefined"==typeof n)var n={},n={shareObj:function(t,e){"undefined"==typeof window.CloudSdkPlugin&&(window.CloudSdkPlugin={}),window.CloudSdkPlugin.hasOwnProperty("STK")||(window.CloudSdkPlugin.STK={}),window.CloudSdkPlugin.STK[t]=e},getObj:function(t){if("undefined"==typeof window.CloudSdkPlugin&&(window.CloudSdkPlugin={}),!window.CloudSdkPlugin.hasOwnProperty("STK"))throw Error("no "+t+" Obj");return window.CloudSdkPlugin.STK[t]},creatPlugin:function(t,e){"undefined"==typeof window.CloudSdkPlugin&&(window.CloudSdkPlugin={}),window.CloudSdkPlugin[t]=e},getPlugin:function(t,e){if("STK"==t)throw Error(t+" is not support");window.CloudSdkPlugin&&"undefined"!=typeof window.CloudSdkPlugin[t]?e(window.CloudSdkPlugin[t]):r.getJS(n.PluginStack[t],function(){e(window.CloudSdkPlugin[t])},function(){e(null)},this,"utf-8")}};n.shareObj("common.SOTool",n);var r=function(){function e(t){for(var e=[{name:"ie",test:/msie/},{name:"opera",test:/opera/},{name:"firefox",test:/firefox/},{name:"safari",test:/safari.*(?!chrome)/},{name:"chrome",test:/chrome/},{name:"wph",test:/windows phone/},{name:"ps",test:/playstation/},{name:"uc",test:/ucbrowser|ucweb/},{name:"ps",test:/playstation/},{name:"xiaomi",test:/xiaomi/},{name:"qq",test:/qqbrowser/},{name:"weixin",test:/micromessenger/},{name:"360",test:/360browser/},{name:"baidu",test:/baidu/},{name:"qqwebview",test:/ qq/},{name:"sougou",test:/sougou/},{name:"liebao",test:/liebaofast/},{name:"letv",test:/eui browser/}],i="un",o=0;o<e.length;o++){var s=e[o];s.test.test(t)&&(i=s.name)}return i}function i(t){var e="Win32"==navigator.platform||"Windows"==navigator.platform,i="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(i)return"mac";if(e){if(-1<t.indexOf("windows nt 5.0")||-1<t.indexOf("windows 2000"))return"win2000";if(-1<t.indexOf("windows nt 5.1")||-1<t.indexOf("windows XP"))return"winXP";if(-1<t.indexOf("windows nt 5.2")||-1<t.indexOf("windows 2003"))return"win2003";if(-1<t.indexOf("windows nt 6.0")||-1<t.indexOf("windows vista"))return"winVista";if(-1<t.indexOf("windows nt 6.1")||-1<t.indexOf("windows 7"))return"win7"}return/android/.test(t)?"android":t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||t.match(/iphone/)||t.match(/ipad/)?"ios":"X11"!=navigator.platform||e||i?-1<String(navigator.platform).indexOf("Linux")?"linux":"un":"unix"}var o=navigator.userAgent.toLowerCase(),s={br:"",device:"",ver:"",params:null,os:""};return{br:s,getOs:function(){return""==s.os&&(s.os=i(o)),s.os},getUrlParams:function(t){if(null==s.params){var e=window.location.search,i={};if(-1!=e.indexOf("?"))for(var e=e.substr(1).split("&"),o=0;o<e.length;o++){var n=e[o].substr(0,e[o].indexOf("=")),r=e[o].substr(e[o].indexOf("=")+1);i[n]=r}s.params=i}return s.params&&s.params.hasOwnProperty(t)?s.params[t]:!1},getDevice:function(){if(""==s.device){var t;t:{t=[{name:"wph",test:/windows phone/},{name:"ipad",test:/ipad/},{name:"iphone",test:/iphone/},{name:"androidPad",test:/(?!.*mobile)android/},{name:"androidPhone",test:/android.*mobile/},{name:"android",test:/android/},{name:"pc",test:/windows/},{name:"mac",test:/macintosh|mac os x/}];for(var e=0;e<t.length;e++){var i=t[e];if(i.test.test(o)){t=i.name;break t}}t="un"}s.device=t}return s.device},getBrowser:function(){return""==s.br&&(s.br=e(o)),s.br},getBrowserVersion:function(){if(""==s.br&&(s.br=e(o)),""==s.ver){var t,i={};(t=o.match(/msie ([\d.]+)/))?i.msie=t[1]:(t=o.match(/firefox\/([\d.]+)/))?i.firefox=t[1]:(t=o.match(/360browser/))?i.b360=t[1]?t[1]:"-":(t=o.match(/qqbrowser\/([\d.]+)/))?i.bqq=t[1]:(t=o.match(/ucbrowser\/([\d.]+)/))?i.buc=t[1]:(t=o.match(/baidubrowser\/([\d.]+)/))?i.bbaidu=t[1]:(t=o.match(/sogoumobilebrowser\/([\d.]+)/))?i.bsgm=t[1]:(t=o.match(/liebaofast\/([\d.]+)/))?i.blbfast=t[1]:(t=o.match(/mb2345browser\/([\d.]+)/))?i.b2345=t[1]:(t=o.match(/4g explorer\/([\d.]+)/))?i.b4g=t[1]:(t=o.match(/huohoubrowser\/([\d.]+)/))?i.bhuohou=t[1]:(t=o.match(/maxthon[\/ ]([\d.]+)/))?i.maxthon=t[1]:(t=o.match(/(opera)|(opr)\/([\d.]+)/))?i.opera=t[3]:(t=o.match(/chrome\/([\d.]+)/))?i.chrome=t[1]:(t=o.match(/version\/([\d.]+).*safari/))?i.safari=t[1]:i.other="-",t="";for(var n in i)t=i[n];s.ver=t}return s.br+s.ver},now:Date.now||function(){return+new Date},getJS:function(e,i,o,s,n,r){if("undefined"!=typeof e){var a,l=t.head||t.getElementsByTagName("head")[0]||t.documentElement,h=t.createElement("script");h.type="text/javascript",n&&(h.charset=n),h.onload=h.onreadystatechange=function(){h.readyState&&"loaded"!=h.readyState&&"complete"!=h.readyState||(h=h.onreadystatechange=h.onload=h.onerror=null,clearTimeout(a),"function"==typeof i&&i.call(s))},h.onerror=function(){h=h.onload=h.onreadystatechange=h.onerror=null,clearTimeout(a),"function"==typeof o&&o.call(s)},h.src=e,l.appendChild(h),r||(r=1e4),a=setTimeout(function(){clearTimeout(a),"function"==typeof o&&o()},r)}},getJSON:function(e,i,o,s,n,r){var a,l=this.now(),h="letvcloud"+l+Math.floor(100*Math.random()),d="$1"+h+"$2",p=0,c=0,u=this,f=-1,y=t.head||t.getElementsByTagName("head")[0]||t.documentElement;/_r=/i.test(e)||(e+="&callback=?"),e=e.replace(/(\=)\?(&|$)|\?\?/i,d),s=s||5e3;var g=n||2,m=r||1e3;window[h]=function(t){v(),window[h]=null,f=-1,i.call(this,t,{responseTime:u.now()-l,retryCount:p})};var v=function(){clearTimeout(c),a&&a.parentNode&&(y.removeChild(a),a.onload=a.onreadystatechange=null,a.onerror=null,a=void 0)},E=function(){v(),p>=g?(clearTimeout(c),window[h]=null,o&&o.call(this,null,{responseTime:u.now()-l,retryCount:p,error:f})):setTimeout(w,m)},w=function(){v(),p++,e=e.replace(/&_r=[\d|\?]+/i,"&_r="+p),a=t.createElement("script"),a.setAttribute("type","text/javascript"),a.setAttribute("src",e),a.setAttribute("charset","utf-8"),a.onload=a.onreadystatechange=function(t){a.onload=a.onreadystatechange=null,clearTimeout(c)},y.insertBefore(a,y.firstChild),f=1,c=setTimeout(E,s)};w()},getJSONbyAjax:function(t,e,i,o,s,n){var r,a=this.now(),l=0,h=this,d=-1;o=o||5e3;var p=s||2,c=n||1e3,u=function(){clearTimeout(0),r&&(r.onreadystatechange=null)},f=function(){u(),l>=p?(clearTimeout(0),i&&i.call(this,null,{responseTime:h.now()-a,retryCount:l,error:d})):setTimeout(y,c)},y=function(){u(),l++,r=new XMLHttpRequest,r.timeout=o,r.onreadystatechange=function(t){4==r.readyState&&(200==r.status?(t=r.responseText,u(),d=-1,e.call(this,t,{responseTime:h.now()-a,retryCount:l})):f())},r.ontimeout=f,r.open("GET",t,!0),r.send(),d=1};y()},creatUuid:function(){var t,e,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];for(e=16,t=0;32>t;t++)o[t]=i[0|Math.random()*e];return o.join("")},objectParseToString:function(t){if(null==t)return"";var e,i="",o=0;for(e in t)i=o>0?i+("&"+e+"="+t[e]):i+(e+"="+t[e]),o++;return i},cookie:function(e,i,o){if("undefined"==typeof i){if(i=null,t.cookie&&""!=t.cookie)for(o=t.cookie.split(";"),s=0;s<o.length;s++)if(n=o[s],n.substring(0,e.length+1)==e+"="){i=decodeURIComponent(n.substring(e.length+1));break}return i}o=o||{},null===i&&(i="",o.expires=-1);var s="";o.expires&&("number"==typeof o.expires||o.expires.toUTCString)&&("number"==typeof o.expires?(s=new Date,s.setTime(s.getTime()+864e5*o.expires)):s=o.expires,s="; expires="+s.toUTCString());var n=o.path?"; path="+o.path:"",r=o.domain?"; domain="+o.domain:"";return o=o.secure?"; secure":"",t.cookie=[e,"=",encodeURIComponent(i),s,n,r,o].join(""),null},setLocal:function(t,e,i){if(window.localStorage)try{localStorage.setItem(t,e)}catch(o){}this.cookie(t,e,i)},getLocal:function(t){if(window.localStorage)try{if(localStorage.getItem(t))return localStorage.getItem(t)}catch(e){}return this.cookie(t)},num2Time:function(t){var e;return e=10>parseInt(t/60)?"0"+parseInt(t/60)+":":parseInt(t/60)+":",t=10>parseInt(t%60)?"0"+parseInt(t%60):parseInt(t%60)+"",e+t},clone:function(t){var e,i,o;if("object"!=("undefined"==typeof t?"undefined":_typeof(t))||null===t)return t;if(t instanceof Array)for(e=[],i=0,o=t.length;o>i;i++)e[i]="object"==_typeof(t[i])&&null!=t[i]?arguments.callee(t[i]):t[i];else for(i in e={},t)e[i]="object"==_typeof(t[i])&&null!=t[i]?arguments.callee(t[i]):t[i];return e},isHttps:function(){try{return"https:"==window.location.protocol}catch(t){}return!1},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},addUrlParams:function(t,e){for(var i=0;i<t.length;i++){var o,s=t[i];for(o in e)-1==s.indexOf("&"+o+"=")&&-1==s.indexOf("?"+o+"=")&&(s=-1!=s.indexOf("?")?s+("&"+o+"="+e[o]):s+("?"+o+"="+e[o]));t[i]=s}},bindFun:function(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}}}}();n.shareObj("common.videoSdkTool",r),r.checkPano=function(){try{var e=t.createElement("canvas");if(window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl")))switch(r.getDevice()){case"androidPad":case"androidPhone":case"android":if("chrome"==r.getBrowser()||"firefox"==r.getBrowser())return!0;break;case"pc":return!0}}catch(i){}return!1},n.shareObj("common.videoSdkTool",r);var a={decode:function(t){var e,i,o,s,n,r=0,a=0;s="";var l=[];if(!t)return t;t+="";do e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(r++)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(r++)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(r++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(r++)),o=e<<18|i<<12|s<<6|n,e=o>>16&255,i=o>>8&255,o&=255,64==s?l[a++]=String.fromCharCode(e):64==n?l[a++]=String.fromCharCode(e,i):l[a++]=String.fromCharCode(e,i,o);while(r<t.length);return s=l.join("")},encode:function(t){var e,i,o,s,n=0,r=0,a="",a=[];if(!t)return t;t=this.utf8_encode(t+"");do e=t.charCodeAt(n++),i=t.charCodeAt(n++),o=t.charCodeAt(n++),s=e<<16|i<<8|o,e=s>>18&63,i=s>>12&63,o=s>>6&63,s&=63,a[r++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s);while(n<t.length);switch(a=a.join(""),t.length%3){case 1:a=a.slice(0,-2)+"==";break;case 2:a=a.slice(0,-1)+"="}return a}},l={getTemplate:function(t,e,i,o){"undefined"!=typeof i&&(i=i.replace(/{#}/g,o),e=e.replace(/{#}/g,o),l.loadCss(i)),i=(new Date).getTime(),o=e.match(/#{[a-z_A-Z0-9]{1,}}/g)||[];for(var s=[],n=0;n<o.length;n++){var r=o[n].replace(/^#{?|}$/g,"");e=e.replace(o[n],r+i),s.push(r)}for(t.innerHTML=e,n=0;n<s.length;n++)r=s[n],t[r]=l.$E(r+i);return s},loadCss:function(e){var i=t.head||t.getElementsByTagName("head")[0]||t.documentElement,o=t.createElement("style");o.setAttribute("type","text/css"),o.innerHTML=e,i.appendChild(o)},$E:function(e){return e="string"==typeof e?t.getElementById(e):e,null!=e?e:null},$C:function(e){return t.createElement(e)},hasClassName:function(t,e){if(t){var i=t.className;return 0==i.length?!1:!(i!=e&&!i.match(new RegExp("(^|\\s)"+e+"(\\s|$)")))}},addClassName:function(t,e){if(t){var i=t.className;0==i.length?t.className=i:i==e||i.match(new RegExp("(^|\\s)"+e+"(\\s|$)"))||(t.className=i+" "+e)}},removeClassName:function(t,e){if(t){var i=t.className;0!=i.length&&(i==e?t.className="":i.match(new RegExp("(^|\\s)"+e+"(\\s|$)"))&&(t.className=i.replace(new RegExp("(^|\\s)"+e+"(\\s|$)")," ")))}},addEvent:function(t,e,i){if(-1!=e.indexOf(",")){e=e.split(",");for(var o=0,s=e.length;s>o;o++){var n=e[o];if(""==n)break;t.attachEvent?t.attachEvent("on"+n,i):t.addEventListener(n,i,!1)}}else t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i,!1)},removeEvent:function(t,e,i){if(t=this.$E(t),null!=t&&"function"==typeof i&&"undefined"!=typeof e)if(-1!=e.indexOf(",")){e=e.split(",");for(var o=0,s=e.length;s>o;o++){var n=e[o];if(""==n)break;t.addEventListener?t.removeEventListener(n,i,!1):t.attachEvent&&t.detachEvent("on"+n,i)}}else t.addEventListener?t.removeEventListener(e,i,!1):t.attachEvent&&t.detachEvent("on"+e,i)},getPos:function(e){if(e=this.$E(e),e.getBoundingClientRect){var i="CSS1Compat"==t.compatMode?t.documentElement:t.body;return e=e.getBoundingClientRect(),{x:e.left+i.scrollLeft,y:e.top+i.scrollTop}}for(i=y_=0;e.offsetParent;)i+=e.offsetLeft,y_+=e.offsetTop,e=e.offsetParent;return i+=e.offsetLeft,y_+=e.offsetTop,{x:i,y:y_}},getMousePoint:function(e){var i="createTouch"in t,o=y=0,s=t.documentElement,n=t.body;return e||(e=window.event),window.pageYOffset?(o=window.pageXOffset,y=window.pageYOffset):(o=(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),y=(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),i?(e=e.touches.item(0),o=e.pageX,y=e.pageY):(o+=e.clientX,y+=e.clientY),{x:o,y:y}},preventDefault:function(t){t?t.preventDefault():window.event.returnValue=!1},turnEvent:function(t){var e={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend",mouseover:"touchstart",mouseout:"-",click:"touchstart"};return l.isSupportsTouches()&&e.hasOwnProperty(t)?e[t]:t},isSupportsTouches:function(e){return"createTouch"in t},drag:function(e,i){var o="createTouch"in t,s=l.turnEvent("mousedown"),n=l.turnEvent("mousemove"),r=l.turnEvent("mouseup");"string"==typeof e&&(e=t.getElementById(e)),e.orig_index=e.style.zIndex,e.startX=0,e.startY=0,e["on"+s]=function(s){function a(s){return s||(s=window.event),o?(s=s.touches.item(0),d=s.pageX-u,p=s.pageY-f):(d=s.pageX?s.pageX-u:s.clientX+t.body.scrollLeft-u,p=s.pageY?s.pageY-f:s.clientY+t.body.scrollTop-f),d=g.x+d,p=g.x+p,y&&(d<y.x?d=y.x:d>y.x+y.w&&(d=y.x+y.w),p<y.y?p=y.y:p>y.y+0+y.h&&(p=y.y+y.h)),e.style.left=d+"px",e.style.top=p+"px",i.onMove&&i.onMove((parseInt(e.style.left)-y.x)/y.w),!1}function h(){e.releaseCapture?e.releaseCapture():window.captureEvents&&window.captureEvents(A.MOUSEMOVE|A.MOUSEUP),l.removeEvent(c,n,a),l.removeEvent(c,r,h),e.style.zIndex=e.orig_index,i.onUp&&i.onUp((parseInt(e.style.left)-y.x)/y.w)}var d,p,c=t;p=d=void 0;var u,f,y;this.style.zIndex=1e4,i.rect&&(y=i.rect()),s||(s=window.event),s.preventDefault(),o?(s=s.touches.item(0),u=s.pageX,f=s.pageY):(u=s.clientX+c.body.scrollLeft,f=s.clientY+c.body.scrollTop);var g={x:parseInt(e.offsetLeft),y:parseInt(e.offsetTop)};return c.ondragstart="return false;",c.onselectstart="return false;",c.onselect="document.selection.empty();",e.setCapture?e.setCapture():window.captureEvents&&window.captureEvents(A.MOUSEMOVE|A.MOUSEUP),i.onDown&&i.onDown((parseInt(e.style.left)-y.x)/y.w),l.addEvent(c,n,a),l.addEvent(c,r,h),!1}},fullScreen:function(t){return t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.oRequestFullscreen?t.oRequestFullscreen():void 0},isFullScreen:function(){return!!(t.webkitIsFullScreen||t.fullscreen||t.mozFullScreen||t.msFullscreenElement)},cancelFullScreen:function(){t.cancelFullscreen?t.cancelFullscreen():t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.webkitCancelFullScreen&&element.webkitCancelFullScreen()},supportFullScreen:function(){var e=t.documentElement;return"requestFullscreen"in e||"mozRequestFullScreen"in e&&t.mozFullScreenEnabled||"webkitRequestFullscreen"in e||"msRequestFullscreen"in e},getClientWidth:function(){return t.body.clientWidth}};n.shareObj("common.UiTool",l);var h={isString:function(t){return"string"==typeof t},stringToJson:function(t){if(!this.isString(t))return t;try{return window.JSON.parse(t)}catch(e){return{}}},isJson:function(t){return!(!t||"object"!==("undefined"==typeof t?"undefined":_typeof(t))||"Object"!==t.constructor)},jsonToString:function(t){var e="";try{e=window.JSON.stringify(t)}catch(i){e=i}return e}},d=function(){var e=t.createElement("DIV");e.style.cssText="width:85%;height:80%;position:fixed;left:0px;top:0px;z-index: 3000;background-color:rgba(255, 255, 255, 1);";var i=t.createElement("IFRAME");i.name="submit",i.style.cssText="display:none;position:absolute;";var o=t.createElement("form");return{print:function(i,o){e.innerHTML='<div style="width:100%;"><span>用户id:</span><input type="text" style="width:300px;"><input style="float:right;" type="button" value="关闭"></div><textarea class="input" style="width: 100%;height: 100%"  placeholder="Once upon a time..."></textarea>',t.body.appendChild(e),e.style.display="",e.getElementsByTagName("textarea")[0].innerHTML=i;var s=e.getElementsByTagName("input")[0];e.getElementsByTagName("input")[1].onclick=function(){e.style.display="none"},s.value=o},report:function(e,s){t.body.appendChild(i),o.innerHTML="",o.action=e,o.method="post",o.target="submit",o.style.display="none";for(var n in s){var r=t.createElement("textarea");r.name=n,r.value=s[n],o.appendChild(r)}t.body.appendChild(o),o.submit()}}}(),p=function(){var e="",i=[];return{log:function(o,s,n){if(s="undefined"!=typeof s?"["+s.constructor.name+"]":"-",n="undefined"!=typeof n?n:"-",e!=o)try{var r=new Date,a="["+r.getFullYear()+"-"+r.getMonth()+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+":"+r.getMilliseconds()+"]";if(i.push(a+o+"  target-->"+s),1e3<i.length&&i.shift(),(-1!=window.location.href.indexOf("#dSDK=1")||"file"==window.location.href.substr(0,4).toLocaleLowerCase())&&window.console&&window.console.log(o,s,n,a),-1!=window.location.href.indexOf("#dSDK=2")){if(t.getElementById("log"))var l=t.createElement("DIV");else{var h=t.createElement("DIV");h.id="log",t.body.appendChild(h),l=t.createElement("DIV")}l.innerHTML=o+s+a,t.getElementById("log").appendChild(l),e=o}}catch(d){}},getLog:function(t){return i.join("<br>\r\n")}}}();p.log("js 加载成功  ua:"+window.navigator.userAgent);var c={isSupportFlash:!1,isEmdbed:!1,num:0,check:function(t){var e="";if("undefined"!=typeof window.ActiveXObject)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){}if(window.navigator.plugins&&window.navigator.plugins["Shockwave Flash"])try{e=window.navigator.plugins["Shockwave Flash"].description,this.isEmdbed=!0}catch(o){}""==e&&(this.isSupportFlash=!1);for(var e=e.split(/\s+/),s=0,n=e.length;n>s;s++)parseInt(e[s])>t&&(this.isSupportFlash=!0);return this.isSupportFlash},getPlayer:function(e){return this.isEmdbed?t[e]||window[e]:t.getElementById(e)},create:function(e,i,o){var s="cloudPlayer"+(new Date).getTime()+this.num;this.num++;var n,r={bgcolor:"#000000",allowscriptaccess:"always",wmode:"Opaque",width:"100%",height:"100%",align:"middle",quality:"high",allowFullScreen:!0,version:10};for(n in i)r[n]=i[n];if(r.flashvars=o,i="",this.check(r.version)){if(this.isEmdbed)for(n in o=["<embed name='"+s+"'src='"+r.url+"' pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' width='"+r.width+"' height='"+r.height+"' "," />"],i="",r)"width"!=n&&"height"!=n&&"url"!=n&&(i+=n+"='"+r[n]+"' ");else for(n in i="",o=["<object id='"+s+"' classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000'codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,45,0' type='application/x-shockwave-flash' width='"+r.width+"' height='"+r.height+"'><param name='movie' value='"+r.url+"'/>","</object>"],r)"width"!=n&&"height"!=n&&"url"!=n&&(i+="<param name='"+n+"' value='"+r[n]+"'/>");i=o.join(i)}else i='<div style="width:'+r.width+"px; height:"+r.height+'px; text-align:center;"><span style="line-height:200%; font-size:18px">安装或者更新版本不小于<b style="color:red">'+r.version+'</b>的flash播放器, 请点击<a href="http://get.adobe.com/cn/flashplayer/" target="_blank">这里</a>安装</span></div>';return"string"==typeof e&&""!=e&&t.getElementById(e)?t.getElementById(e).innerHTML=i:t.write(i),s}},u=function(){var t={};return{inherits:function(t,e){function i(){}try{i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.prototype.superClass=e.prototype}catch(o){}},provideClass:function(t,e){var i=t.split(".");if(1<i.length)for(var o=0;o<i.length-1;o++){var s=i[o];last.hasOwnProperty(s)||(last[s]={}),last=last[s]}last[i[i.length-1]]=e},importClass:function(e){for(var i=e.split("."),o=t,s=0;s<i.length-1;s++){var n=i[s];if(!o.hasOwnProperty(n))throw"the "+e+"--"+n+" class is not provide";o=o[n]}return o}}}();n.shareObj("common.ClassTool",u);n.PluginStack={ErrorInfo:"http://yuntv.letv.com/player/plugin/errorRender.js",FeedbackInfo:"http://yuntv.letv.com/player/plugin/feedbackRender.js",PanoRender:"http://yuntv.letv.com/player/plugin/panoRender1.1.js"};for(var f in n.PluginStack)"https:"==window.location.protocol&&(n.PluginStack[f]=n.PluginStack[f].replace("http://","https://s."));var g={SkinTpl:"",setMediacontrols:function(t,e){var i;""!=t&&(t="."+t+" "),i="{id}video::-webkit-media-controls-enclosure,{id}video::-webkit-media-controls {display: {dislay} !important;}".replace(/{id}/g,t),i=e?i.replace("{dislay}",""):i.replace("{dislay}","none"),l.loadCss(i)},setMediafullscreen:function(t,e){var i;""!=t&&(t="."+t+" "),i="{id}video::-webkit-media-controls-fullscreen-button {display: {dislay} !important;}".replace(/{id}/g,t),i=e?i.replace("{dislay}",""):i.replace("{dislay}","none"),l.loadCss(i)},getSkinTpl:function(){"undefined"==typeof window.CloudSdkPlugin&&(window.CloudSdkPlugin={}),window.CloudSdkPlugin.skinUuid=r.creatUuid();var t=window.CloudSdkPlugin.skinUuid;if(""==g.SkinTpl){var e;e="@keyframes d{#}{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@-webkit-keyframes d{#}{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}.controlBar{#}{border-top: 1px solid rgb(51, 39, 39);position:absolute;left:0px;bottom:0px;background-color:rgba(0, 0, 0, 0.8);width:100%;height:40px;z-index:5;}.controlBar{#} div{-moz-user-select:none;-webkit-user-select:none;user-select:none;box-sizing:content-box}.hCrtBar{#}{transform: translate(0,41px);-webkit-transform: translate(0,41px);-moz-transform: translate(0,41px);-o-transform: translate(0,41px);-ms-transform: translate(0,41px);}.showError{#}{position:absolute;left: 10%;top:20%;width:80%;height:60%;text-align: center;background-color:rgba(0, 0, 0,.9);border: 1px solid rgb(107, 95, 95);z-index:7;}.loading{#}{position: absolute;background-color:rgba(0, 0, 0,.9);top: 0%;left: 0%;width: 100%;height: 100%;zoom: 1;z-index:4;}.loading{#} .bld_hv{#}{position: absolute;top:50%;left:50%;}.pbtn_hv{#}{width: 75px;height: 75px;overflow: hidden;background: url({#BGP}) no-repeat;margin: -40px 0 0 -38px;}.loading{#} .mld_hv{#}{position: absolute;top: 50%;left: 50%;background-position: -11px -101px;}.loading{#} .mld_hv{#} .ld_mc{#}{margin: 0px;background-position: -11px -201px;animation: d{#} .7s linear 0s infinite;-webkit-animation: d{#} .7s linear 0s infinite}.videoArea{#}{position:absolute;width:100%;height:100%;z-index:3;}.text{#}{color:#fff;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:16px;font-family:Microsoft YaHei, SimSun, Arial;}.tText{#}{color:#fff;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;font-family:Arial;}.definition{#}{float:left;position:absolute;text-align:center;height:27px;line-height:27px;padding: 0px 5px 0px 5px;top: 5px;white-space: nowrap;}.button{#}{cursor:pointer;}.pBack{#}{padding:0px;margin:0px;background:rgba(1, 1, 1, 0) url({#BGP}) no-repeat scroll}.play{#}{width:100%;height:100%;background-position:-10px -5px;}.pause{#}{position:absolute;width:100%;height:100%;background-position:-39px -5px;}.playBar{#}{width:100%;height:5px;background-repeat:repeat;float:left;position: absolute;background-position: 0px -36px;z-index:12;}.playIng_bg{#}{left:0px;top:0px;width:100%;height:40px;position: absolute;margin-top:-18px;z-index:1;}.bufferBar{#}{z-index: 11;background-position: 0px -43px;}.barIco{#}{z-index: 13;background-position:-65px -5px;margin-left:-12px;width: 24px;height: 24px;top:-8px;position:absolute;float:left;}.playBtn{#}{float:left;position: absolute;height: 27px;width: 27px;top:5px;}.pIng{#}{float:left;position: absolute;height: 5px;top:16px;background-position:0px -50px;background-repeat:repeat;width:2px;cursor:pointer;}.pvol{#}{position: absolute;float:left;height: 18px;top: 12px;width:20px;}.vol{#}{background-position:-95px -5px;float:left;height: 100%;width:100%;}.deList{#}{background-color: #261D1D;padding: 2px;position:absolute;}.litem{#}{padding: 7px 18px 7px 18px;text-align: center;height: 25px;line-height: 25px;white-space: nowrap;}.full{#}{float:left;position: absolute;top:12px;width: 19px;height: 20px;}.fullScreen{#}{width: 100%;height: 100%;position:absolute;background-position:-134px -5px;}.cfullScreen{#}{display:none;background-position:-151px -5px;}.time{#}{position:absolute;top:6px;left:0px;pointer-events:none}.duration{#}{position:absolute;top:6px;right:0px;pointer-events:none}.activeText{#}{color:#0099FF;}.logo{#}{float:left;display:none;position: absolute;}.bgBtn{#}{position:absolute;left:50%;top:50%;z-index:7;cursor:pointer;background-position:-111px -101px;}".replace(/{#BGP}/g,"http://yuntv.letv.com/assets/img/skin.png?v=1901"),e=e.replace(/{#}/g,t),l.loadCss(e),e={skin:"<div id='#{videoArea}' class='videoArea{#}'></div><div id='#{controlBar}' class='controlBar{#}'></div><div id='#{loading}' class='loading{#}'></div><div id='#{playBtn}' class='bgBtn{#} pbtn_hv{#}'></div>",controlBar:'<div id="#{playBtnBox}" class="playBtn{#}"><div id="#{playBtn}" class="button{#} pBack{#} play{#}" ></div><div id="#{pauseBtn}" class="button{#} pBack{#} pause{#}" ></div></div> <div id="#{playIngBar}" class="pBack{#} pIng{#}" ><div id="#{playBarIco}" class="button{#} pBack{#} barIco{#}""></div><div id="#{playBar}" class="pBack{#} playBar{#}"></div><div id="#{bufferBar}" class="pBack{#} playBar{#} bufferBar{#}"></div><div id="#{playIngBg}" class="playIng_bg{#}"></div><div id="#{time}" class="tText{#} time{#}" style="left: 0px;"></div><div id="#{duration}" class="tText{#} duration{#}" ></div></div> <div  id="#{volBox}" class="pvol{#}"><div id="#{vol}" class="button{#} pBack{#} vol{#}" ></div></div> <div id="#{definition}" class="text{#} definition{#} button{#}" ></div> <div id="#{definitionList}" class="deList{#}"></div> <div id="#{fullScreenBox}" class="full{#}"  ><div id="#{fullScreen}" class="button{#} pBack{#} fullScreen{#}"></div><div id="#{cancelFullScreen}" class="button{#} pBack{#} fullScreen{#} cfullScreen{#}"></div></div> <div id="#{logo}" class="logo{#}"></div>',loading:'<div id="#{bld}" class="bld_hv{#}"></div><div id="#{sld}" class="mld_hv{#} pbtn_hv{#}"><div class="ld_mc{#} pbtn_hv{#}"></div></div>'};for(var i in e)e[i]=e[i].replace(/{#}/g,t);g.SkinTpl=e}}},m="liveId sid mmsid pic title url nextvid nextpic nexttitle nexturl nextchapter duration total percent rotation fullscreen color volume jump continuePlay gpu gpuing definition defaultDefinition trylook fullScale originalScale originalRect".split(" "),v={rows:[{name:"预览",ename:"",code:"01",reserve3:"300",reserve2:"0",reserve1:"mp4_180"},{name:"流畅",ename:"",code:"10",reserve3:"300",reserve2:"0",reserve1:"mp4_180"},{name:"标清",ename:"",code:"13",reserve3:"500",reserve2:"0",reserve1:"mp4_350"},{name:"高清",ename:"",code:"16",reserve3:"800",reserve2:"0",reserve1:"mp4_800"},{name:"超清",ename:"",code:"19",reserve3:"1300",reserve2:"0",reserve1:"mp4_1300"},{name:"720P",ename:"",code:"22",reserve2:"0",reserve1:"mp4_720p"},{name:"1080P",ename:"",code:"25",reserve2:"0",reserve1:"mp4_1080p"},{name:"4K",ename:"",code:"28",reserve2:"0",reserve1:"mp4_4k"},{name:"原画",ename:"",code:"99",reserve2:"0"}]},E={0:"直播未开始,请稍候",2:"直播信号中断，抢修中，请稍候",3:"直播已经结束"},w=window,S=t,T="playNewId getVideoSetting getVideoTime pauseVideo resumeVideo seekTo replayVideo closeVideo setVolume shutDown startUp getBufferPercent setDefinition getDefinition getDefaultDefinition getDefinitionList setVideoPercent getVideoPercent setVideoScale getVideoScale resetVideoScale fullVideoScale setVideoRect getLoadPercent getDownloadSpeed getPlayRecord getPlayState setVideoColor getVideoColor getVersion setAutoReplay feedback getLog getServerTime callFlash".split(" "),P={PLAY:0,PAUSE:1,STOP:2},b={CHANGESTATEPLAY:0,VOL:2,FULLSCREEN:3,TIME:4,BUFFER:5,LOADING:6,INFO:7,STOP:8,ERROR:9,DURATION:10,DEFINITIONS:11,DEFINITION:13,MAINLOADING:14,CONTROLVISIBLE:14,ERRORHIDE:15,LOGO:18},k={PARAMS:"1",NOSTART:"2",INTERRUPT:"3",END:"7",NOPLAN:"4",PEOPLE_OUT:"5",WHITE_LIST:"6",ACTIVITY_IO:"60",ACTIVITY_TIMEOUT:"61",ACTIVITY_ANALY:"63",NOSTREAM:"64",LIVE_ANALY:"50",LIVE_IO:"51",LIVE_TIMEOUT:"53",PLAY_IO:"480",PLAY_TIMEOUT:"481",VOD_CONFIG_IO:"150",VOD_CONFIG_TIMEOUT:"152",VOD_MMSID_ANALY:"153",VOD_CONFIG_DRM:"154",GSLB_IO:"470",GSLB_ANALY:"473",NOSupport:"490"},L=function(){function t(){this.init()}return t.prototype={init:function(){},addEventListener:function(t,e,i){if("undefined"==typeof t)throw this.log(t),Error("type is undefined");if("undefined"==typeof e)throw this.log(e),Error("handler is undefined");if("undefined"==typeof i)throw this.log(i),Error("handlerThis is undefined");this.hasOwnProperty("EventMap")||(this.EventMap={}),this.EventMap.hasOwnProperty(t)||(this.EventMap[t]=[]),this.hasEventListener(t,e,i)||this.EventMap[t].push({fun:e,target:i})},hasEventListener:function(t,e,i){if("undefined"==typeof t)throw this.log(t),Error("type is undefined");if("undefined"==typeof e)throw this.log(e),Error("handler is undefined");if("undefined"==typeof i)throw this.log(i),Error("handlerThis is undefined");if(this.hasOwnProperty("EventMap")&&this.EventMap.hasOwnProperty(t))for(var o=0;o<this.EventMap[t].length;o++){var s=this.EventMap[t][o];if(s.fun==e&&s.target==i)return!0}return!1},dispatchEvent:function(t){var e=t.type;if(t.target=this,this.hasOwnProperty("EventMap")||(this.EventMap={}),this.EventMap.hasOwnProperty(e)){for(var i=[],o=0;o<this.EventMap[e].length;o++)i.push(this.EventMap[e][o]);for(o=0;o<i.length;o++)i[o].fun.call(this.EventMap[e][o].target,t)}},removeEventListener:function(t,e,i){if(this.hasOwnProperty("EventMap")||(this.EventMap={}),this.EventMap.hasOwnProperty(t))for(var o=0;o<this.EventMap[t].length;o++)if(this.EventMap[t][o].fun==e&&this.EventMap[t][o].target==i){this.EventMap[t].splice(o,1),0==this.EventMap[t].length&&delete this.EventMap[t];break}},destroy:function(){for(var t in this.EventMap)delete this.EventMap[t];this.EventMap=null},log:function(t){p.log(t,this)}},t}();n.shareObj("core.ClassObject",L);var I=function(){function t(t,e){this.init(t,e)}return u.inherits(t,L),t.prototype.init=function(t,e){this.facade=t,this.model=e},t}(),A=function(){return function(){this.type=arguments[0],this.args=arguments}}(),O=function(){function t(){}return u.inherits(t,L),t}(),C=function(){function t(){}return u.inherits(t,L),t.prototype.load=function(t){this.loader=new R,this.isClose=!1,t=this.getRequestList(),this.log("requestUrls:"+h.jsonToString(t)),2==this.requestType?this.loader.load2(t,this.loadCmp,this.loadError,this):this.loader.load(t,this.loadCmp,this.loadError,this)},t.prototype.getUrl=function(t){return 1<this.loader.urlList.length?this.loader.urlList[0].url:""},t.prototype.getRequestList=function(t){return[]},t.prototype.unload=function(t){this.loader&&this.loader.destroy(),this.isClose=!0},t.prototype.loadCmp=function(t,e){!this.isClose&&this.dispatchEvent(new A(U.LOADCMP,[t,e]))},t.prototype.loadError=function(t,e){
!this.isClose&&this.dispatchEvent(new A(U.LOADERROR,[t,e]))},t}(),D=function(){function t(){}return u.inherits(t,L),t.prototype.initPlugin=function(t,e,i){this.pluginCmpFun=e,this.REConf=i,this.REConf.hasOwnProperty(t.type)?(e=this.REConf[t.type],e.hasOwnProperty("check")?"function"==typeof e.check?e.check()?this.load(t):t.onerror(e.err):e.check?this.load(t):t.onerror(e.err):this.load(t)):(this.pluginCmpFun(null),t.onstart())},t.prototype.load=function(t){var e=this;e.pl=this.REConf[t.type],n.getPlugin(e.pl.name,function(t){t?e.pluginCmpFun(t):e.onerror({code:420,message:"插件加载错误"})})},t}(),x=function(){function t(t,e){this.facade=t,this.model=e,this.init()}return u.inherits(t,L),t.prototype.init=function(){this.tplKey="view",this.addEvent=!0},t.prototype.setUp=function(t,e){""==g.SkinTpl&&g.getSkinTpl();var i=g.SkinTpl[this.tplKey]||"";if(this.el=l.$E(t),this.skin=new V(this.el),i=l.getTemplate(this.el,i),e)for(var o=0;o<i.length;o++)this.el[i[o]]=new V(this.el[i[o]]);this.addEvent&&this.facade.addEventListener(F.EVENT,this.skinHandler,this)},t.prototype.skinHandler=function(t){},t.prototype.setSize=function(t,e){},t}(),V=function(){function t(t,e){this.init(t),"undefined"==typeof e&&(e=window.CloudSdkPlugin.skinUuid),this.sid=e}var e=n.getObj("common.ClassTool"),i=n.getObj("core.ClassObject"),o=n.getObj("common.UiTool");return e.inherits(t,i),t.prototype.init=function(t){this.el=t},t.prototype.addEventListener=function(t,e,i){t=o.turnEvent(t),"-"!=t&&o.addEvent(this.el,t,e)},t.prototype.removeEventListener=function(t,e,i){t=o.turnEvent(t),o.removeEvent(this.el,t,e)},t.prototype.drag=function(t){o.drag(this.el,t)},t.prototype.setVisible=function(t){t?(this.el.style.display="block",this.setAttribute({orgwidth:this.el.offsetWidth,orgheight:this.el.offsetHeight})):this.el.style.display="none"},t.prototype.getVisible=function(){return"none"!=this.el.style.display},t.prototype.setWidth=function(t){t+="",-1!=t.indexOf("%")?this.el.style.width=t:this.el.style.width=t+"px"},t.prototype.getWidth=function(){return 0==this.el.offsetWidth?this.getAttribute("orgwidth"):this.el.offsetWidth},t.prototype.setHeight=function(t){t+="",-1!=t.indexOf("%")?this.el.style.height=t:this.el.style.height=t+"px"},t.prototype.getHeight=function(){return 0==this.el.offsetHeight?this.getAttribute("orgheight"):this.el.offsetHeight},t.prototype.setX=function(t){t+="",-1!=t.indexOf("%")?this.el.style.left=t:this.el.style.left=t+"px"},t.prototype.getX=function(){return this.el.offsetLeft},t.prototype.setY=function(t){t+="",-1!=t.indexOf("%")?this.el.style.top=t:this.el.style.top=t+"px"},t.prototype.getY=function(){return this.el.offsetTop},t.prototype.appendChild=function(t){t.hasOwnProperty("el")&&(t=t.el),this.el.appendChild(t)},t.prototype.html=function(t){this.el.innerHTML=t},t.prototype.setClassName=function(t){t=t.split(" ").join(this.sid+" "),t+=this.sid,this.el.className=t},t.prototype.hasClassName=function(t){return t=t.split(" ").join(this.sid+" "),t+=this.sid,o.hasClassName(this.el,t)},t.prototype.addClassName=function(t){t=t.split(" ").join(this.sid+" "),t+=this.sid,o.addClassName(this.el,t)},t.prototype.removeClassName=function(t){t=t.split(" ").join(this.sid+" "),t+=this.sid,o.removeClassName(this.el,t)},t.prototype.getAttribute=function(t){return this.el.getAttribute(t)},t.prototype.hasAttribute=function(t){return this.el.hasAttribute(t)},t.prototype.setAttribute=function(t){for(var e in t)this.el.setAttribute(e,t[e])},t.prototype.removeAttribute=function(t){if(r.isArray(t))for(var e=0;e<t.length;e++)this.el.removeAttribute(t[e]);else this.el.removeAttribute(t)},t.prototype.setStyle=function(t){for(var e in t)this.el.style[e]=t[e]},t}();n.shareObj("core.view.DisplayObject",V);var R=function(){function t(){}return t.prototype={load:function(t,e,i,o){this.urlList=t;var s=this,n=0,a=r.now(),l=function h(){clearTimeout(s.delayID),r.getJSON(s.urlList[0].url,function(t,i){n+=i.retryCount,e&&e.call(o,t,{responseTime:r.now()-a,retryCount:n})},function(t,e){1<s.urlList.length?(n+=s.urlList[0].maxCount,s.urlList.shift(),s.delayID=setTimeout(h,s.urlList[0].retryTime)):(n+=e.retryCount,i&&i.call(o,null,{responseTime:r.now()-a,retryCount:n}))},s.urlList[0].timeout,s.urlList[0].maxCount,s.urlList[0].retryTime)};l()},load2:function(t,e,i,o){this.urlList=t;var s=this,n=0,a=r.now(),l=function h(){clearTimeout(s.delayID),r.getJSONbyAjax(s.urlList[0].url,function(t,i){n+=i.retryCount,e&&e.call(o,t,{responseTime:r.now()-a,retryCount:n})},function(t,e){1<s.urlList.length?(n+=s.urlList[0].maxCount,s.urlList.shift(),s.delayID=setTimeout(h,s.urlList[0].retryTime)):(n+=e.retryCount,i&&i.call(o,null,{responseTime:r.now()-a,retryCount:n}))},s.urlList[0].timeout,s.urlList[0].maxCount,s.urlList[0].retryTime)};l()},destroy:function(){clearTimeout(this.delayID)}},t}(),N=function(){function t(t,e,i,o){this.delay=t,this.timerHandler=i,this.handlerThis=e,"undefined"==typeof o&&(o=0),this.max=o,this.currentCount=this.T=0,this.running=!0}return t.prototype={start:function(){this.running=!0,this.checkTime(!1)},checkTime:function(t){var e=this;return clearTimeout(this.T),t&&(e.currentCount++,e.timerHandler.call(e.handlerThis),0<e.max&&e.currentCount>=e.max)?void e.stop():void(e.T=setTimeout(function(){e.checkTime.call(e,!0)},e.delay))},stop:function(){this.running=!1,clearTimeout(this.T)},reset:function(){this.stop(),this.currentCount=0},clear:function(){this.handlerThis=this.timerHandler=this.delay=null,this.T=0}},t}(),H=function(){return{EVENT:"adEvent",HEADSTART:"adHeadPlayStart",HEADEND:"adHeadPlayComplete",NOAD:"adHeadPlayNone"}}(),U=function(){return{LOADCMP:"loadcmp",LOADERROR:"loaderror"}}(),B=function(){return{EVENT:"playerEvent",INIT:"playerInit",VIDEO_AUTH_VALID:"videoAuthValid",VIDEO_DATA_START:"videoDataStart",VIDEO_DATA_CMP:"videoDataCmp",GSLB_START:"gslbStart",GSLB_CMP:"gslbCmp",VPH:"videoPageHide",VPS:"videoPageShow",WPH:"webPageHide",ERROR:"playerError",RESIZE:"playerResize",VIDEO_INFO:"videoInfo",FULLSCREEN:"fullscreen",PRESIZE:"resize",VIDEO_LIVESTOP:"videoLiveStop",VIDEO_INTERRUPT:"videoLiveInterupt"}}(),_=function(){return{EVENT:"MediaEvent",CONNECT:"videoConnect",START:"videoStart",PLAY:"videoResume",STOP:"videoStop",PAUSE:"videoPause",BUFFEREMPTY:"videoEmpty",BUFFEREFULL:"videoFull",SEEK:"videoSeek",SEEKEMPTY:"videoSeekEmpty",PLAYING:"videoPlaying",LODING:"videoLoading",METADATA:"MetaData",DURATION:"videoDuration",DEFSTART:"swapDefinition",ERROR:"videoError",REPLAY:"videoReplay"}}(),F=function(){return _defineProperty({EVENT:"skinEvent",PLAY:"skinPlay",PAUSE:"skinPause",SETDEFINITION:"setDefinition",SEEK:"skinSeek",VOLUME:"skinVolume",FULLSCREEN:"skinFullScreen",REPLAY:"skinReplay"},"FULLSCREEN","skinFullscreen")}(),M=function(){function t(){for(var t="mac nt os osv app bd xh ro cs ssid lo la".split(" "),e=this,i=0;i<t.length;i++)this[t[i]]="";this.refresh=function(t){for(var i in t)e[i]=t[i]}}function e(){var t=this;this.autoplay=0,this.refresh=function(e){for(var i in e)t[i]=e[i]}}function i(){var t=this;this.refresh=function(e){for(var i in e)t[i]=e[i]}}function o(){for(var t=["userId"],e=this,i=0;i<t.length;i++)this[t[i]]="";this.refresh=function(t){for(var i in t)e[i]=t[i]}}function s(){for(var t="title duration volume definition defaultDefinition fullscreen percent time url videoWidth videoHeight".split(" "),e=this,i=0;i<t.length;i++)this[t[i]]="";this.definitionCount=0,this.refresh=function(t){for(var i in t)e[i]=t[i]}}function n(){this.systemData=new t,this.config=new e,this.reportParam={},this.clear()}return n.prototype={init:function(t){switch(this.platform){case"sdk":this._uuid="",this.playType=t.ptype,delete t.ptype;for(var e="autoplay uu vu liveId streamId activityId".split(" "),i=0;i<e.length;i++){var o=e[i];t.hasOwnProperty(o)&&(this.config[o]=t[o],delete t[o])}this.systemData.refresh(t),p.log("[Stat K]  model init:"+this.systemData.deviceId+"  _2016-04-25 19:28:53.088"),this._apprunid=this.systemData.deviceId+"_"+r.now();break;case"html5":this.systemData.refresh(t),this._apprunid=this.lc()+"_"+r.now()}},clear:function(){this._uuid="",this._lc=r.getLocal("lc"),this.userData=new o,this.videoSetting=new s,this.playerConfig=new i,this.platform="html5",this.playType="vod"},uuid:function(){if("sdk"==this.platform){if(this.videoSetting.hasOwnProperty("uuid")&&6<this.videoSetting.uuid.length)return this.videoSetting.uuid;var t=ExternalInterface.callSDK(this.systemData.os,"getVideoSetting","");if(this.videoSetting.refresh(t),this.videoSetting.hasOwnProperty("uuid")&&6<this.videoSetting.uuid.length)return this.videoSetting.uuid}return""==this._uuid&&(this._uuid=r.creatUuid()),this._uuid+"_"+this.videoSetting.definitionCount},clearUuid:function(){this._uuid=""},lc:function(){return null==this._lc&&(this._lc=r.creatUuid(),r.setLocal("lc",this._lc)),this._lc},getTypeFrom:function(){var t=r.getUrlParams("ch");if(t)return t.toString();try{if(""!=this.userInfo().userId)return"bcloud_"+this.userInfo().userId}catch(e){}return"letv"},apprunid:function(){return this._apprunid},auid:function(){return this.systemData.deviceId},pcode:function(){return"-"},videoInfo:function(){switch(this.platform){case"sdk":var t=ExternalInterface.callSDK(this.systemData.os,"getVideoSetting","");return t.hasOwnProperty("cid")&&""!=t.cid||(t.cid=100),t.hasOwnProperty("liveid")&&(t.lid=t.liveid,delete t.liveid),t.hasOwnProperty("time")&&""==t.time&&(t.time="0"),this.videoSetting.refresh(t),t;case"html5":return t=this.api.getVideoInfo(),this.videoSetting.refresh(t),t}},userInfo:function(){switch(this.platform){case"sdk":if(""==this.userData.userId){var t=ExternalInterface.callSDK(this.systemData.os,"getUserSetting","");this.userData.refresh(t)}return this.userData;case"html5":return this.userData}}},n}(),z=function(){function t(t){this.model=t}var e=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"];return u.inherits(t,C),t.prototype.getRequestList=function(){for(var t=[],i="http://api.live.letvcloud.com/rtmp/getPlayerConfigeration?ver=v4",o=["activityId"],s=0;s<o.length;s++){var n=o[s];this.model.config.hasOwnProperty(n)?i="domain"==n?i+("&key="+this.model.config[n]):i+("&"+n+"="+this.model.config[n]):this.model.videoSetting.hasOwnProperty(n)&&(i+="&"+n+"="+this.model.videoSetting[n])}for(i+="&clientType=4",t.push({url:i,timeout:5e3,maxCount:3,retryTime:0}),s=0;s<e.length;s++)-1!=t[0].url.indexOf("//api.live.letvcloud.com/")&&(o=i.replace("//api.live.letvcloud.com/",e[s]),t.push({url:o,timeout:5e3,maxCount:3,retryTime:0}));return t},t.prototype.loadCmp=function(t,e){if(!this.isClose){t=a.decode(t.value),t=h.stringToJson(t),this.log("config data"+h.jsonToString(t)+"----time:"+h.jsonToString(e));var i=this.model,o={};o.userId=t.customerId,i.userData.refresh(o),o={},o.liveId=t.liveId;for(var s={},n=0;n<t.streams.length;n++){var r=t.streams[n];if(1==r.streamState){s.hasOwnProperty(r.rateType)||(s[r.rateType]={},s[r.rateType].videoWidth=r.width,s[r.rateType].videoHeight=r.height,s[r.rateType].sid=r.streamId,s[r.rateType].definition=r.rateName,s[r.rateType].urls=[]),s[r.rateType].urls.push(r.streamUrl);break}}o.media=s,i.videoSetting.refresh(o),this.dispatchEvent(new A(U.LOADCMP,[t,e]))}},t}(),j=function(){function t(t){this.model=t}var e=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"];return u.inherits(t,C),t.prototype.getRequestList=function(){var t=[],i="http://api.live.letvcloud.com/rtmp/getActivityInfoForPlayer?ver=v4&keyType=1",o=["activityId","domain","p","customerId"];this.getP();for(var s=0;s<o.length;s++){var n=o[s];this.model.config.hasOwnProperty(n)&&(i="domain"==n?i+("&key="+this.model.config[n]):i+("&"+n+"="+this.model.config[n]))}for(i+="&cf="+this.getCf(),t.push({url:i,timeout:5e3,maxCount:3,retryTime:0}),s=0;s<e.length;s++)-1!=t[0].url.indexOf("//api.live.letvcloud.com/")&&(o=i.replace("//api.live.letvcloud.com/",e[s]),t.push({url:o,timeout:5e3,maxCount:3,retryTime:0}));return t},t.prototype.getCf=function(){switch(r.getDevice()){case"ipad":return"h5-ipad";case"iphone":return"h5-ios";case"androidPad":return"h5-androidpad";case"androidPhone":return"h5-android";case"wph":case"pc":return"h5-win";case"mac":return"h5-mac"}return this.model.config.hasOwnProperty("cf")?this.model.config.cf:"other"},t.prototype.getP=function(t){this.model.config.hasOwnProperty("p")||(this.model.config.p=100)},t.prototype.loadCmp=function(t,e){if(!this.isClose){this.log("activeProxy data"+h.jsonToString(t)+"----time:"+h.jsonToString(e));var i=this.model,o=!1,s={};s.activityId=t.activityId,s.title=t.activityName,s.isdrm=0,s.ark=t.ark,s.hasAd=t.isNeedAd,s.pic=t.coverImgUrl,i.config.hasOwnProperty("customerId")&&i.userData.refresh({userId:i.config.customerId}),t.hasOwnProperty("businessline")?s.p=t.businessline:this.model.config.hasOwnProperty("p")&&(s.p=this.model.config.p),"http"!=s.pic.substr(0,4)&&(s.pic="");for(var n=0;n<t.lives.length;n++){var r=t.lives[n];if(1==r.status||3==r.status){o=!0,s.liveId=r.liveId;break}}o||(s.liveId=t.lives[0].liveId),i.playerConfig.refresh({mloadingUrl:"",loadingUrl:"",logo:{pic:"",pos:"",url:""}}),i.videoSetting.refresh(s),o?this.dispatchEvent(new A(U.LOADCMP,[t,e])):(i={code:k.INTERRUPT},3==t.lives[0].status?(i={code:k.END},i.errInfo="url:"+this.getUrl()+" respponse:"+h.jsonToString(t),this.dispatchEvent(new A(U.LOADERROR,[i,e]))):this.checkActStatus())}},t.prototype.checkActStatus=function(t,e){this.lRequest=new G(this.model);var i={code:k.INTERRUPT};this.lRequest.addEventListener(U.LOADCMP,function(t){if(!this.isClose){switch(t.args[1][0]+""){case"2":i={code:k.INTERRUPT};break;case"3":i={code:k.END};break;case"0":i={code:k.NOSTART}}i.message=E[t.args[1][0]],this.dispatchEvent(new A(U.LOADERROR,[i,e]))}},this),this.lRequest.addEventListener(U.LOADERROR,function(t){this.isClose||this.dispatchEvent(new A(U.LOADERROR,[i,e]))},this),this.lRequest.load()},t.prototype.loadError=function(t,e){this.isClose||this.dispatchEvent(new A(U.LOADERROR,[{code:k.ACTIVITY_TIMEOUT,errInfo:"url:"+this.getUrl()},e]))},t}(),Y=function(){function t(t){this.model=t}var e=["//183.247.178.242/v3","//111.206.211.222/v3","//106.39.244.240/v3"];return u.inherits(t,C),t.prototype.getRequestList=function(){for(var t=[],i="http://api.live.letvcloud.com/v3/rtmp/rtmplive/playInfo?playType=2&keyType=1",o=["liveId","domain","p","customerId"],s=0;s<o.length;s++){var n=o[s];this.model.config.hasOwnProperty(n)?i="domain"==n?i+("&key="+this.model.config[n]):i+("&"+n+"="+this.model.config[n]):this.model.videoSetting.hasOwnProperty(n)&&(i+="&"+n+"="+this.model.videoSetting[n])}for(i+="&clientType=4",t.push({url:i,timeout:5e3,maxCount:3,retryTime:0}),s=0;s<e.length;s++)-1!=t[0].url.indexOf("//api.live.letvcloud.com/v3")&&(o=i.replace("//api.live.letvcloud.com/v3",e[s]),t.push({url:o,timeout:5e3,maxCount:3,retryTime:0}));return t},t.prototype.loadCmp=function(t,e){if(!this.isClose){t=a.decode(t.value),t=h.stringToJson(t),this.log("liveid data"+h.jsonToString(t)+"----time:"+h.jsonToString(e));var o=this.model,s={};s.userId=t.customerId,o.userData.refresh(s),s={},s.liveId=t.liveId,this.model.config.hasOwnProperty("activityId")||(s.ark=0,s.hasAd=!1,s.pic="",s.isdrm=0,o.playerConfig.refresh({mloadingUrl:"",loadingUrl:"",logo:{pic:"",pos:"",url:""}}));for(var n={},r=!1,l=0;l<t.streams.length;l++){var d=t.streams[l];if(0<d.streamState){n.hasOwnProperty(d.rateType)||(n[d.rateType]={},n[d.rateType].videoWidth=d.width,n[d.rateType].videoHeight=d.height,n[d.rateType].sid=d.streamId,n[d.rateType].definition=i(d.rateType),n[d.rateType].vtype=d.rateType,n[d.rateType].urls=[]),o.liveback=!1,1!=d.streamState&&(o.liveback=!0),n[d.rateType].urls.push(d.streamUrl),r=!0;break}}r?(s.media=n,o.videoSetting.refresh(s),this.dispatchEvent(new A(U.LOADCMP,[t,e]))):(o=t.streams[0],s={code:k.INTERRUPT},0==o.streamState?s={code:k.NOSTART}:2==o.streamState?s={code:k.INTERRUPT}:3==o.streamState&&(s={code:k.END}),s.message=E[o.streamState],s.errInfo="url:"+this.getUrl()+" respponse:"+h.jsonToString(t),this.dispatchEvent(new A(U.LOADERROR,[s,e])))}},t.prototype.loadError=function(t,e){this.isClose||this.dispatchEvent(new A(U.LOADERROR,[{code:k.LIVE_IO,errInfo:"url:"+this.getUrl()},e]))},t}(),W=function(){function t(t){this.model=t}var e=["//183.247.178.242/v3","//111.206.211.222/v3","//106.39.244.240/v3"];return u.inherits(t,Y),t.prototype.getRequestList=function(){for(var t=[],i="http://api.live.letvcloud.com/v3/rtmp/rtmplive/playInfo?playType=2&keyType=1",o=["streamId","domain"],s=0;s<o.length;s++){var n=o[s];this.model.config.hasOwnProperty(n)&&(i="domain"==n?i+("&key="+this.model.config[n]):i+("&"+n+"="+this.model.config[n]))}for(i+="&clientType=4",t.push({url:i,timeout:5e3,maxCount:3,retryTime:0}),s=0;s<e.length;s++)-1!=t[0].url.indexOf("//api.live.letvcloud.com/v3")&&(o=i.replace("//api.live.letvcloud.com/v3",e[s]),t.push({url:o,timeout:5e3,maxCount:3,retryTime:0}));return t},t}(),G=function(){function t(t){this.model=t}var e=[];return u.inherits(t,C),t.prototype.getRequestList=function(){for(var t=[],i="http://api.live.letvcloud.com/rtmp/getActivityStatus?ver=v4",o=["activityId","liveId","streamId"],s=0;s<o.length;s++){var n=o[s];this.model.config.hasOwnProperty(n)?i+="&"+n+"="+this.model.config[n]:this.model.videoSetting.hasOwnProperty(n)&&(i+="&"+n+"="+this.model.videoSetting[n])}for(i+="&clientType=4",t.push({url:i,timeout:5e3,maxCount:3,retryTime:0}),s=0;s<e.length;s++)-1!=t[0].url.indexOf("//api.live.letvcloud.com/")&&(o=i.replace("//api.live.letvcloud.com/",e[s]),t.push({url:o,timeout:5e3,maxCount:3,retryTime:0}));return t},t.prototype.loadCmp=function(t,e){this.isClose||(this.log("直播状态接口返回："+t),t.hasOwnProperty("errCode")||t.hasOwnProperty("status")&&this.dispatchEvent(new A(U.LOADCMP,[t.status,e])))},t}(),q=function(){function t(t){this.model=t,this.requestType=2}var e=[];return u.inherits(t,C),t.prototype.getRequestList=function(){var t=[];t.push({url:"http://hdns.lecloud.com/d?dn=r.gslb.lecloud.com",timeout:2e3,maxCount:2,retryTime:0});for(var i=0;i<e.length;i++)if(-1!=t[0].url.indexOf(replace)){var o="http://hdns.lecloud.com/d?dn=r.gslb.lecloud.com".replace(replace,e[i]);t.push({url:o,timeout:2e3,maxCount:2,retryTime:0})}return t},t.prototype.loadCmp=function(t,e){this.isClose||this.dispatchEvent(new A(U.LOADCMP,[t,e]))},t.prototype.loadError=function(t,e){this.isClose||this.dispatchEvent(new A(U.LOADERROR,[{code:k.ACTIVITY_TIMEOUT,errInfo:"url:"+this.getUrl()},e]))},t}(),K=function(){function t(t){this.model=t}return u.inherits(t,C),t.prototype.getRequestList=function(){var t=[],e=r.clone(this.model.videoSetting.urls);r.addUrlParams(e,{jsonp:"?",_r:"jsonp",format:1,expect:3});for(var i=0;i<e.length;i++){var o=this.checkGslbUrl(e[i]);t.push({url:o,timeout:1e4,maxCount:3,retryTime:0})}return t},t.prototype.checkGslbUrl=function(t){return"ios"==this.model.vodPlayType&&-1==t.indexOf("&tss=ios&")&&(t=-1!=t.indexOf("&tss=no&")?t.replace("&tss=no&","&tss=ios&"):t+"&tss=ios"),"mp4"==this.model.vodPlayType&&-1==t.indexOf("&tss=no&")&&(t=-1!=t.indexOf("&tss=ios&")?t.replace("&tss=ios&","&tss=no&"):t+"&tss=no"),t},t.prototype.loadCmp=function(t,e){if(!this.isClose)if(this.log("gslb data:"+h.jsonToString(t)+" time"+h.jsonToString(e)),200==t.status){t.ercode="0";for(var i=[t.location],o=0;o<t.nodelist.length;o++)t.nodelist[o].location!=i[0]&&i.push(t.nodelist[o].location);this.dispatchEvent(new A(U.LOADCMP,i))}else this.dispatchEvent(new A(U.LOADERROR,[{code:k.GSLB_ANALY,message:"调度错误"},e]))},t.prototype.loadError=function(t,e){this.isClose||this.dispatchEvent(new A(U.LOADERROR,[{code:k.GSLB_IO,errInfo:"url:"+this.getUrl()},e]))},t}(),X=function(){function e(){this.lastTime=this.pt=0,this.isStartPlay=this.isPauseRecord=!1,this.state="",this.replaytype=1}function i(t){this.model=t,this.reset()}var o={pc:{value:30,sub:{value:300}},sdk:{value:32,sub:{value:321,ios:{value:321},android:{value:322}}},html5:{value:31,sub:{value:310,ios:{value:311},android:{value:312},pc:{value:310}}}},s={android:600,ios:601};return i.prototype={init:function(){this.model.reportParam.p1=3,this.model.reportParam.p2=o[this.model.platform.toLowerCase()].value,o[this.model.platform.toLowerCase()].sub.hasOwnProperty(this.model.systemData.os.toLowerCase())?this.model.reportParam.p3=o[this.model.platform.toLowerCase()].sub[this.model.systemData.os.toLowerCase()].value:this.model.reportParam.p3=o[this.model.platform.toLowerCase()].sub.value},reset:function(){this.heartTimer&&(this.heartTimer.stop(),this.heartTimer=null),this.reportParam=new e},onStateChanged:function(t,e){switch(e=h.stringToJson(e),p.log("[Stat K 日志数据]  type:"+t+" data:"+e),t){case"init":this.reportParam.isStartPlay=!1,this.model.init(e),this.init(),this.sendEnvStat();break;case"start":this.reportParam.isStartPlay=!1,this.sendPlayStat("init");break;case"play":this.reportParam.isStartPlay||(this.sendPlayStat("play",e),this.startHeartTimer(),this.resumePtStat(),this.reportParam.isStartPlay=!0);break;case"bufferEmpty":this.reportParam.state!=t&&this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("block"));break;case"bufferFull":"bufferEmpty"==this.reportParam.state&&this.reportParam.isStartPlay&&(this.resumePtStat(),this.sendPlayStat("eblock")),this.reportParam.isStartPlay||(this.reportParam.isStartPlay=!0);break;case"seek":this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("drag",{py:{dr:this.model.videoInfo().time+"_"+e.time}}));break;case"pause":this.reportParam.state!=t&&this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("pa"));break;case"resume":this.reportParam.isStartPlay&&this.resumePtStat();break;case"definition":this.reportParam.isStartPlay&&(this.pausePtStat(),this.model.videoSetting.definitionCount++,this.reportParam.replaytype=2,this.sendPlayStat("tg"));break;case"stopPlay":this.reportParam.isStartPlay&&(this.reportParam.isStartPlay=!1,this.pausePtStat(),this.pauseHeadStat(),this.sendPlayStat("end"));break;case"playStop":this.reportParam.isStartPlay&&(this.reportParam.isStartPlay=!1,this.pauseHeadStat(),this.sendPlayStat("end"),this.sendPlayStat("finish"));break;case"hide":null!=this.heartTimer&&this.reportParam.isStartPlay&&(this.pausePtStat(!0),this.heartTimer.stop());break;case"show":null!=this.heartTimer&&this.reportParam.isStartPlay&&(this.resumePtStat(!0),this.heartTimer.start());break;case"error":this.reportParam.isStartPlay=!1,this.sendErrorStat(e),null!=this.heartTimer&&this.heartTimer.stop()}this.reportParam.state=t},startHeartTimer:function(){this.heartTimer?this.heartTimer.running||(this.setDelay(),this.heartTimer.start()):(this.heartTimer=new N(18e4,this,this.heartHanlder),this.setDelay(),this.heartTimer.start())},pauseHeadStat:function(){this.heartHanlder(),this.heartTimer&&this.heartTimer.stop()},setDelay:function(){if(this.heartTimer)switch(this.heartTimer.currentCount){case 0:this.heartTimer.delay=15e3;break;case 1:this.heartTimer.delay=6e4;break;default:this.heartTimer.delay=18e4}},heartHanlder:function(){this.pausePtStat(!0),this.resumePtStat(!0),this.setDelay(),this.sendPlayStat("time"),this.reportParam.pt=0},pausePtStat:function(t){"undefined"==typeof t&&(t=!1);var e=r.now();this.reportParam.isPauseRecord||0==this.reportParam.lastTime||(this.reportParam.pt+=e-this.reportParam.lastTime),0==this.reportParam.lastTime&&(this.reportParam.pt=0),this.reportParam.lastTime=e,t||(this.reportParam.isPauseRecord=!0)},resumePtStat:function(t){"undefined"==typeof t&&(t=!1);var e=r.now();this.reportParam.lastTime=e,t||(this.reportParam.isPauseRecord=!1)},sendEnvStat:function(){var t,e=this.model;t="http://apple.www.letv.com/env/?ver=3.0.5&p1="+this.model.reportParam.p1,t+="&p2="+this.model.reportParam.p2,t+="&p3="+this.model.reportParam.p3,"html5"==this.model.platform&&(t+="&lc="+e.lc()),"sdk"==this.model.platform&&(t+="&auid="+e.auid()),t+="&uuid="+e.uuid(),t+="&mac="+e.systemData.mac,t+="&nt="+e.systemData.nt,t+="&os="+e.systemData.os,t+="&osv="+e.systemData.osv,t+="&app="+e.systemData.appv,t+="&bd="+encodeURIComponent(e.systemData.bd),t+="&xh="+encodeURIComponent(e.systemData.xh),t+="&ro="+encodeURIComponent(e.systemData.ro),t+="&src=pl",t+="&ch="+e.getTypeFrom(),t+="&cs="+encodeURIComponent(e.systemData.cs),t+="&ssid="+encodeURIComponent(e.systemData.ssid),t+="&lo="+encodeURIComponent(e.systemData.lo),t+="&la="+encodeURIComponent(e.systemData.la),t+="&apprunid="+e.apprunid(),t+="&r="+Math.random(),this.report(t)},sendPlayStat:function(e,i){var o,n=this.model;o="http://apple.www.letv.com/cloud_pl/?ver=3.0.5&p1="+this.model.reportParam.p1,o+="&p2="+this.model.reportParam.p2,o+="&p3="+this.model.reportParam.p3,o+="&ac="+e,o+="&prg="+n.videoInfo().time,"time"==e&&(18e4<this.reportParam.pt&&(this.reportParam.pt=18e4),o+="&pt="+Math.abs(Math.round(.001*this.reportParam.pt))),"html5"==this.model.platform&&(o+="&lc="+n.lc()),"sdk"==this.model.platform&&(o+="&auid="+n.auid()),o+="&uuid="+n.uuid(),"vod"==n.playType&&(o+="&cid="+n.videoSetting.cid,""!=n.videoSetting.pid&&(o+="&pid="+n.videoSetting.pid),o+="&vid="+n.videoSetting.vid,o+="&ty=0",o+="&vlen="+n.videoSetting.duration),"live"==n.playType&&(o+="&lid="+n.videoSetting.lid,o+="&sid="+n.videoSetting.sid,o+="&ty=1",o+="&vlen=6000",n.videoSetting.hasOwnProperty("activityId")&&(o+="&zid="+n.videoSetting.activityId)),o+="&ch="+n.getTypeFrom(),o+="&vt="+n.videoSetting.vtype,o+="&pv="+encodeURIComponent(this.model.systemData.appv),"sdk"==this.model.platform&&(i||(i={}),i.hasOwnProperty("py")||(i.py={}),i.py.replaytype=this.reportParam.replaytype),this.model.videoSetting.hasOwnProperty("p")&&(i||(i={}),i.hasOwnProperty("py")||(i.py={}),i.py.p=this.model.videoSetting.p),null!=i&&i.hasOwnProperty("py")&&(o+="&py="+encodeURIComponent(r.objectParseToString(i.py))),"sdk"==this.model.platform&&(o+="&pcode="+this.model.pcode(),o+="&nt="+n.systemData.nt),o+="&ap="+this.model.config.autoplay,"init"==e&&"sdk"==this.model.platform&&(o+="&cdev="+n.systemData.cdev,o+="&caid="+s[n.systemData.os.toLowerCase()]),"play"==e&&(o+="&pay=0",i&&i.hasOwnProperty("cv")&&(o+="&stc="+encodeURIComponent(r.objectParseToString(i.cv.stc)),o+="&joint="+i.cv.joint)),o+="&prl=0",o+="&ctime="+r.now(),o+="&custid="+n.userInfo().userId,o+="&ipt=0",o+="&owner=1",o+="&apprunid="+n.apprunid(),"sdk"!=this.model.platform&&(o+="&url="+encodeURIComponent(window.location.href),o+="&ref="+encodeURIComponent(t.referrer)),o+="&r="+Math.random(),this.report(o)},sendErrorStat:function(t){var e,i=this.model;e="http://apple.www.letv.com/er/?ver=3.0.5&p1="+this.model.reportParam.p1,e+="&p2="+this.model.reportParam.p2,e+="&p3="+this.model.reportParam.p3,e+="&et=pl",e+="&err="+t.errcode,"html5"==this.model.platform&&(e+="&lc="+i.lc()),"sdk"==this.model.platform&&(e+="&auid="+i.auid()),e+="&mac="+i.systemData.mac,e+="&nt="+i.systemData.nt,e+="&os="+i.systemData.os,e+="&osv="+i.systemData.osv,e+="&app="+i.systemData.appv,e+="&bd="+i.systemData.bd,e+="&xh="+i.systemData.xh,e+="&ro="+i.systemData.ro,"vod"==i.playType&&(e+="&cid="+i.videoSetting.cid,""!=i.videoSetting.pid&&(e+="&pid="+i.videoSetting.pid),e+="&vid="+i.videoSetting.vid),"live"==i.playType&&(e+="&lid="+i.videoSetting.lid,e+="&sid="+i.videoSetting.sid),t={ch:i.getTypeFrom(),custid:i.userInfo().userId},this.model.videoSetting.hasOwnProperty("p")&&(t.p=this.model.videoSetting.p);for(var o=["uu","vu","liveId","streamId","activityId"],s=0;s<o.length;s++)i.config.hasOwnProperty(o[s])&&(t[o[s]]=i.config[o[s]]);e+="&ep="+encodeURIComponent(r.objectParseToString(t)),e+="&ap="+i.config.autoplay,e+="&uuid="+i.uuid(),e+="&apprunid="+i.apprunid(),e+="&r="+Math.random(),this.report(e)},report:function(t){if("html5"==this.model.platform){p.log("[Stat K]  url:"+t);var e=new Image(1,1);e.onload=e.onerror=e.onabort=function(){e=e.onload=e.onerror=e.onabort=null},e.src=t}"sdk"==this.model.platform&&ExternalInterface.callSDK(this.model.systemData.os,"logRequest",{url:t})}},i}(),$=function(){function t(t){this.model=t,this.DelayT=0,this.isComplete=this.getUrlsList=!1}var e={"r.gslb.lecloud.com":""};return u.inherits(t,L),t.prototype.setUp=function(t,e){this.requestHttpDNS(),this.getUrlsList=!1,t.hasOwnProperty("activityId")?this.requestDataByActiveId():t.hasOwnProperty("liveId")?this.requestDataByLiveId():t.hasOwnProperty("streamId")?this.requestDataByStreamId():this.dispatchEvent(new A(U.LOADERROR,[{code:k.PARAMS}]))},t.prototype.requestDataByLiveId=function(t){t=new Y(this.model),t.addEventListener(U.LOADCMP,this.dataCmp,this),t.addEventListener(U.LOADERROR,this.errorHanlder,this),t.load()},t.prototype.requestDataByStreamId=function(t){t=new W(this.model),t.addEventListener(U.LOADCMP,this.dataCmp,this),t.addEventListener(U.LOADERROR,this.errorHanlder,this),t.load()},t.prototype.requestDataByActiveId=function(t){t=new j(this.model),t.addEventListener(U.LOADCMP,this.activeCmp,this),t.addEventListener(U.LOADERROR,this.errorHanlder,this),t.load()},t.prototype.requestHttpDNS=function(t){t=new q(this.model),t.addEventListener(U.LOADCMP,this.onDNSCmp,this),t.addEventListener(U.LOADERROR,this.onDNSError,this),t.load()},t.prototype.onDNSCmp=function(t){this.log("httpDNS解析成功："+t.args[1][0]),e["r.gslb.lecloud.com"]=t.args[1][0].split(";"),e["r.gslb.lecloud.com"].push("r.gslb.lecloud.com"),this.getUrlsList&&this.refreshUrlsData()},t.prototype.onDNSError=function(t){this.log("httpDNS解析失败"),e["r.gslb.lecloud.com"]=["r.gslb.lecloud.com"],this.getUrlsList&&this.refreshUrlsData()},t.prototype.activeCmp=function(t){this.requestDataByLiveId()},t.prototype.activeConfig=function(t){t=new z(this.model),t.addEventListener(U.LOADCMP,this.configCmp,this),t.load()},t.prototype.configCmp=function(t){this.requestDataByLiveId()},t.prototype.errorHanlder=function(t){this.dispatchEvent(new A(U.LOADERROR,t.args[1]))},t.prototype.dataCmp=function(t){if(this.isComplete=!1,this.getUrlsList=!0,""!=e["r.gslb.lecloud.com"])this.log("httpDNS解析已经成功"),this.refreshUrlsData();else{var i=this;this.log("httpDNS解析未成功"),i.DelayT=setTimeout(function(){i.log("httpDNS解析超过最大等待时间，1000"),i.refreshUrlsData.call(i)},1e3)}},t.prototype.destroy=function(){},t.prototype.refreshLoadingData=function(){this.model.config.hasOwnProperty("loadingurl")&&(this.model.playerConfig.mloadingUrl=0==this.model.config.loadingurl?this.model.playerConfig.loadingUrl:this.model.config.loadingurl)},t.prototype.refreshUrlsData=function(){if(this.DelayT&&clearTimeout(this.DelayT),!this.isComplete){if(this.isComplete=!0,""!=e["r.gslb.lecloud.com"])for(var t in this.model.videoSetting.media){for(var i=[],o=0;o<this.model.videoSetting.media[t].urls.length;o++)for(var s=0;s<e["r.gslb.lecloud.com"].length;s++){var n=this.model.videoSetting.media[t].urls[o].replace("r.gslb.lecloud.com",e["r.gslb.lecloud.com"][s]);i.push(n)}0<i.length&&(this.model.videoSetting.media[t].urls=i)}this.dispatchEvent(new A(U.LOADCMP))}},t}(),J=function(){function t(){}return u.inherits(t,L),t.prototype.init=function(){this.playUrlList=[],this.playingRetry=!0,this.isFtc=this.startPlay=this.autoplay=!1,this.playState=0,this.render=null,this.emptyDelay=1e3},t.prototype.setConfig=function(t){},t.prototype.errorHandler=function(t){(!this.startPlay||this.playingRetry)&&1<this.playUrlList.length&&t&&t.code&&4!=t.code?(this.playUrlList.shift(),this.log("播放失败， errCode:"+t.code+",切换下一个地址:"+this.playUrlList[0]),this.changeurl(this.playUrlList[0])):(t.hasOwnProperty("retryCdn")||(t.retryCdn=!0),t.hasOwnProperty("code")||(t.code=k.PLAY_TIMEOUT),this.log("播放失败: errCode:"+t.code+",url:"+this.playUrlList[0]),this.dispatchEvent(new A(_.EVENT,_.ERROR,[t])))},t.prototype.onPlaySeekHandler=function(){this.emptyST&&clearTimeout(this.emptyST),this.startPlay&&(this.playState=5,this.dispatchEvent(new A(_.EVENT,_.SEEK,this.getTime())))},t.prototype.onPlayFullHandler=function(){this.startPlay||(this.startPlay=!0,this.dispatchEvent(new A(_.EVENT,_.START)),this.render&&this.render.start()),1!=this.playState&&(this.playState=1,this.dispatchEvent(new A(_.EVENT,_.BUFFEREFULL,this.getTime()))),this.emptyST&&clearTimeout(this.emptyST)},t.prototype.onPlayEmptyHandler=function(){var t=this;t.emptyST&&clearTimeout(t.emptyST),t.startPlay&&3!=t.playState&&(5!=t.playState?(t.playState=3,
t.emptyST=setTimeout(function(){t.dispatchEvent(new A(_.EVENT,_.BUFFEREMPTY,t.getTime()))},t.emptyDelay)):(t.playState=3,t.dispatchEvent(new A(_.EVENT,_.SEEKEMPTY,t.getTime()))))},t.prototype.onPlaStopHandler=function(){this.emptyST&&clearTimeout(this.emptyST),4!=this.playState&&(this.playState=4,this.dispatchEvent(new A(_.EVENT,_.STOP,!0)))},t.prototype.onPlayHandler=function(){this.emptyST&&clearTimeout(this.emptyST),this.playState=1,this.dispatchEvent(new A(_.EVENT,_.PLAY,this.getTime()))},t.prototype.onPauseHandler=function(){this.emptyST&&clearTimeout(this.emptyST),this.playState=2,this.dispatchEvent(new A(_.EVENT,_.PAUSE,this.getTime()))},t.prototype.onPlayIngHandler=function(){var t=this.getTime();t>=0&&!this.isFtc&&(t>0?(this.log("第一次获得非0的播放时间"+t),this.isFtc=!0,this.onPlayFullHandler()):"iphone"==r.getDevice()&&"qq"==r.getBrowser()&&this.onPlayFullHandler()),this.startPlay&&this.dispatchEvent(new A(_.EVENT,_.PLAYING,t))},t.prototype.onLoadIngHandler=function(){this.dispatchEvent(new A(_.EVENT,_.LODING,this.getLoadPercent()))},t.prototype.onMetaDataHandler=function(t){this.videoWidth=t.width||0,this.videoHeight=t.height||0,0<this.videoWidth&&0<this.videoHeight&!this.hasMetadata&&(this.setSize(),this.hasMetadata=!0,this.dispatchEvent(new A(_.EVENT,_.METADATA,{videoWidth:this.videoWidth,videoHeight:this.videoHeight,duration:this.duration}))),this.mduration&&0==t.duration&&(t.duration=this.mduration),0<t.duration&&this.duration!=t.duration&&(this.duration=t.duration,this.dispatchEvent(new A(_.EVENT,_.DURATION,{duration:this.duration})))},t}(),Z=function(){function e(){var t=this;this.type="video",this.videoHandlerBack=function(){t.videoHandler.apply(t,arguments)}}var i=0,o="error emptied abort playing play pause ended canplay waiting loadeddata loadedmetadata timeupdate seeked seeking progress durationchange".split(" ");return u.inherits(e,J),e.prototype.destroy=function(){this.removeEvents(),this.video.pause(),this.video.src="",this.render&&this.render.close()},e.prototype.setPoster=function(t){this.video.poster=t},e.prototype.setUp=function(e,o){i++;var s,n="LecoudPlayer"+(new Date).getTime()+i,r=["preload","controls","width","height"];for(s='<div id="v{id}" style="left:0px;top:0px;width:100%;height:100%;display: block;position: relative;"><video  id="{id}" controls="controls"  style="width:100%;height:100%;"></video></div>'.replace(/{id}/g,n),o.innerHTML=s,this.outEl=o,this.video=t.getElementById(n),this.videoBox=t.getElementById("v"+n),this.config=e,this.isEndStartSeek=!(0<this.config.start),e.hasOwnProperty("pic")&&(this.video.poster=e.pic),e.hasOwnProperty("autoplay")&&"1"==e.autoplay?(this.video.autoplay="autoplay",this.autoplay=!0):this.autoplay=!1,e.hasOwnProperty("playsinline")&&"1"==e.playsinline&&(this.video.hasOwnProperty("WebKitPlaysInline")?this.video.WebKitPlaysInline=!0:(this.video.setAttribute("webkit-playsinline",""),this.video.setAttribute("playsinline",""))),n=0;n<r.length;n++)e.hasOwnProperty(r[n])&&"width"!=r[n]&&"height"!=r[n]&&(this.video[r[n]]=e[r[n]]);this.isShow=!0,this.vArea=this.videoBox,0<this.outEl.offsetWidth&0<this.outEl.offsetHeight||(this.videoBox.style.width="99.5%",this.videoBox.style.height="99.5%")},e.prototype.enableControls=function(){this.video.controls=!0},e.prototype.disableControls=function(){this.video.controls=!1},e.prototype.setContainer=function(t){this.vArea=t},e.prototype.setLoop=function(t){},e.prototype.hide=function(t){this.isShow&&(t?this.video.style.display="none":(this.tmpwidth=this.videoBox.style.width,this.tmpheight=this.videoBox.style.height,this.videoBox.style.width="1px",this.videoBox.style.height="1px",this.videoBox.style.left="-1000px",this.videoBox.style.top="-1000px"),this.isShow=!1)},e.prototype.show=function(){this.isShow||(this.videoBox.style.display="",this.videoBox.style.width=this.tmpwidth,this.videoBox.style.height=this.tmpheight,this.videoBox.style.left="0px",this.videoBox.style.top="0px",this.isShow=!0)},e.prototype.setSize=function(){if(this.display=!!(0<this.outEl.offsetWidth&0<this.outEl.offsetHeight),this.isShow)if(this.config.dvideoSize)this.display&&(this.videoBox.style.width="100%",this.videoBox.style.height="100%");else if(0<this.videoWidth&&0<this.videoHeight&0<this.outEl.offsetWidth&0<this.outEl.offsetHeight){var t,e;this.videoWidth/this.videoHeight>this.outEl.offsetWidth/this.outEl.offsetHeight?(t=this.outEl.offsetWidth,e=this.videoHeight*this.outEl.offsetWidth/this.videoWidth):(e=this.outEl.offsetHeight,t=this.videoWidth*this.outEl.offsetHeight/this.videoHeight),this.videoBox.style.width=t+"px",this.videoBox.style.height=e+"px",this.videoBox.style.top=.5*(this.outEl.offsetHeight-this.videoBox.offsetHeight)+"px",this.videoBox.style.left=.5*(this.outEl.offsetWidth-this.videoBox.offsetWidth)+"px"}this.render&&this.render.setSize(this.vArea.offsetWidth,this.vArea.offsetHeight)},e.prototype.addEvents=function(){for(var t=this.video,e=0;e<o.length;e++)t.addEventListener(o[e],this.videoHandlerBack,!0)},e.prototype.removeEvents=function(){for(var t=this.video,e=0;e<o.length;e++)t.removeEventListener(o[e],this.videoHandlerBack,!0)},e.prototype.videoHandler=function(t){switch(t.type){case"error":if("firefox"==r.getBrowser()&&null==this.video.error)break;if(this.video.error&&4==this.video.error.code&&0<this.getTime())break;t={code:k.PLAY_TIMEOUT},this.video.error&&this.video.error.hasOwnProperty("code")&&(t.code="49"+this.video.error.code),this.errorHandler(t);break;case"playing":this.startPlay||this.onMetaDataHandler({width:this.video.videoWidth,height:this.video.videoHeight,duration:this.video.duration}),this.autoSeek(),this.isEndStartSeek&&this.onPlayFullHandler(),this.isStartSeek&&(this.isEndStartSeek=!0);break;case"emptied":case"waiting":this.onPlayEmptyHandler();break;case"seeked":this.isEndStartSeek=!0,this.onPlayFullHandler();break;case"seeking":this.onPlaySeekHandler();break;case"play":this.onPlayHandler();break;case"pause":this.onPauseHandler();break;case"ended":this.onPlaStopHandler();break;case"timeupdate":this.display||this.setSize(),this.isEndStartSeek&&this.onPlayIngHandler();break;case"progress":this.onLoadIngHandler();break;case"durationchange":case"loadedmetadata":this.onMetaDataHandler({width:this.video.videoWidth,height:this.video.videoHeight,duration:this.video.duration})}},e.prototype.autoSeek=function(){var t=this;this.log("autoSeek:"+t.config.start+"--"+t.startPlay+"-"+t.isEndStartSeek),0!=t.config.start?t.startPlay||t.isEndStartSeek?t.isStartSeek=!0:setTimeout(function(){t.isStartSeek=!0,t.seek(t.config.start)},500):t.isStartSeek=!0},e.prototype.getLoadPercent=function(){for(var t=this.video.buffered,e=0;e<t.length;e++)if(this.getTime()<t.end(e))return Math.min(1,t.end(e)/this.video.duration);return 0},e.prototype.play=function(t,e,i,o){var s=this;s.hasMetadata=!1,s.playUrlList=t,s.config.start=e,s.url=s.playUrlList[0],s.isEndStartSeek=!(0<s.config.start),s.isStartSeek=!1,this.isFtc=s.startPlay=!1,this.render||(this.render=new Q),this.render.init({type:o,video:this.video,el:this.vArea,onstart:function(){s.log("渲染引擎初始化完毕，回调播放, url:"+s.url),s.addEvents(),s.video.src=s.url,(s.autoplay||i)&&(s.video.load&&s.video.load(),s.video.play())},onerror:function(t){s.log("渲染引擎初始化失败"),t.retryCdn=!1,s.errorHandler(t)}})},e.prototype.resume=function(){this.video.play&&this.video.play()},e.prototype.pause=function(){this.video.pause()},e.prototype.getTime=function(){return this.video.currentTime},e.prototype.seek=function(t){this.log("seek:"+t),this.video.currentTime=t},e.prototype.changeurl=function(t){this.url=t,this.video.src=this.url,this.config.start=this.getTime(),this.isEndStartSeek=!(0<this.config.start),this.video.load(),this.video.play()},e.prototype.setVol=function(t){this.video.volume=t},e.prototype.getVol=function(t){return this.video.volume},e.prototype.stop=function(){this.destroy()},e.prototype.getVideoRect=function(){return{w:this.video.offsetWidth,h:this.video.offsetHeight}},e}(),Q=function(){function t(t){}var e={pano:{name:"PanoRender",check:r.checkPano,err:{code:"",message:""}}};return u.inherits(t,D),t.prototype.init=function(t){this.isStart=!1,this.options=t,this.log("初始化渲染引擎"+this.eg),this.eg?t.type!=this.eg.type?this.eg=null:this.eg.reset(t):this.eg=this.initPlugin(t,this.pluginOk,e)},t.prototype.pluginOk=function(t){this.eg=t?new t(this.options):null},t.prototype.start=function(){this.isStart||(this.isStart=!0,this.eg&&this.eg.start())},t.prototype.close=function(){this.log("关闭渲染引擎"+this.eg),this.eg&&this.eg.close(),this.isStart=!1},t.prototype.setSize=function(t,e){this.eg&&this.eg.setSize(t,e)},t}(),tt=function(){function t(t){this.init(t)}return u.inherits(t,L),t.prototype.init=function(t){this.time=0,this.config=t},t.prototype.setUp=function(t,e){var i=r.clone(this.config),o=["pic","volume"];this.loop=!1,this.el=e,this.volume=t.volume;for(var s=0;s<o.length;s++){var n=o[s];!i.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(i[n]=t[n])}this.creatPlayer(i,e),this.player.duration=t.duration},t.prototype.creatPlayer=function(t,e){this.player&&(this.player.removeEventListener(_.EVENT,this.MediaHanlder,this),this.player.destroy(),this.player=null),this.player=this.getPlayer(t),this.player.init(),this.player.setUp(t,e)},t.prototype.setMedia=function(t){},t.prototype.hide=function(t){this.player.hide(t)},t.prototype.show=function(){this.player.show()},t.prototype.setConfig=function(t){},t.prototype.setContainer=function(t){null!=t&&this.player.setContainer(t)},t.prototype.getPlayer=function(t){return new Z},t.prototype.startPlay=function(t,e,i,o){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=!1),"undefined"==typeof o&&(o=""),this.destroy(),this.setVol(this.volume),this.player.addEventListener(_.EVENT,this.MediaHanlder,this),this.player.mduration=t.duration,this.player.play(t.urls,e,i,o)},t.prototype.setSize=function(){this.player.setSize()},t.prototype.play=function(){this.player.resume()},t.prototype.setVol=function(t){this.player.setVol(t)},t.prototype.pause=function(){this.player.pause()},t.prototype.destroy=function(){this.closeVideo(),this.loop=!1,this.player.setLoop(!1),this.player.destroy()},t.prototype.closeVideo=function(){this.player.removeEventListener(_.EVENT,this.MediaHanlder,this),this.player.stop()},t.prototype.getTime=function(){return parseInt(this.player.getTime())},t.prototype.seek=function(t){t>=0&&0>t-this.player.duration&&(this.player.seek(t),this.player.resume())},t.prototype.getBufferPercent=function(t){return 1},t.prototype.getLoadPercent=function(t){return this.player.getLoadPercent()},t.prototype.setLoop=function(t){this.loop=t,this.player.setLoop(t)},t.prototype.MediaHanlder=function(t){switch(t.args[1]){case _.STOP:if(this.loop)return void this.seek(0)}this.dispatchEvent(t)},t.prototype.changeurl=function(t){this.player.changeurl(t)},t.prototype.getVideoRect=function(){return this.player.getVideoRect()},t.prototype.replay=function(){this.player.seek(0),this.dispatchEvent(new A(_.EVENT,_.REPLAY,this.getTime()))},t.prototype.getVideoEl=function(){return this.player.video},t.prototype.setPoster=function(t){return this.player.setPoster(t)},t}(),et=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,x),t.prototype.init=function(){this.tplKey="controlBar",this.isSeeking=this.addEvent=!1,this.duration=this.model.videoSetting.duration},t.prototype.setUp=function(t){this.superClass.setUp.call(this,t,!0);var e=this;this.el.playBtn.addEventListener("click",function(){e.facade.dispatchEvent(new A(F.EVENT,F.PLAY))}),this.el.pauseBtn.addEventListener("click",function(){e.facade.dispatchEvent(new A(F.EVENT,F.PAUSE))}),this.el.definition.addEventListener("mouseover",function(){e.definitionListShow.apply(e,arguments)}),this.el.definitionList.addEventListener("mouseover",function(t){"touchstart"!=t.type&&e.definitionListShow.apply(e,arguments)}),this.el.definition.addEventListener("mouseout",function(){e.definitionListHide.apply(e,arguments)}),this.el.definitionList.addEventListener("mouseout",function(){e.definitionListHide.apply(e,arguments)}),this.el.fullScreen.addEventListener("click",function(){e.facade.dispatchEvent(new A(F.EVENT,F.FULLSCREEN))}),this.el.playBarIco.drag({rect:function(){var t=e.el.playBarIco.getY(),i=e.el.playIngBar.getWidth();return{x:0,y:t,w:i,h:0}},onDown:function(t){e.isSeeking=!0},onMove:function(t){e.seekHanler.apply(e,[!1])},onUp:function(t){e.seekHanler.apply(e,[!0]),e.isSeeking=!1}}),this.el.playIngBar.addEventListener("click",function(t){var i=l.getPos(e.el.playIngBar.el);t=l.getMousePoint(t),e.el.playBarIco.setX(t.x-i.x),e.seekHanler.apply(e,[!0])}),this.el.playBtn.setVisible(!1),this.el.playBar.setWidth("0%"),this.el.playBarIco.setX(0),this.el.bufferBar.setWidth("0%"),this.el.definitionList.setVisible(!1),this.el.volBox.setVisible(!1),this.setSize(this.el.offsetWidth,this.el.offsetHeight),"live"==this.model.playType&&this.el.playIngBar.setVisible(!1),this.model.config.playIngBg||this.el.playIngBg.setVisible(!1),this.el.fullScreenBox.setVisible(this.model.config.fullscreen),this.el.definition.setVisible(this.model.config.definition)},t.prototype.seekHanler=function(t){var e;this.playRate=(.5*this.el.playBarIco.getWidth()+this.el.playBarIco.getX())/this.el.playIngBar.getWidth(),this.el.playBar.setWidth(100*this.playRate+"%"),e=this.playRate*this.duration,this.el.time.html(r.num2Time(this.playRate*this.duration)),t&&this.facade.dispatchEvent(new A(F.EVENT,F.SEEK,e))},t.prototype.setSize=function(t,e,i){if(i=12,this.el.logo.getVisible()&&0<this.el.logo.getWidth()&&this.el.logo.getHeight()){switch(this.logoInfo.pos){case"left":this.el.logo.setX(i),i=i+this.el.logo.getWidth()+12;break;case"right":this.el.logo.setX(t),t=t-this.el.logo.getWidth()-12}this.el.logo.setY(.5*(e-this.el.logo.getHeight()))}this.el.playBtnBox.setX(i),i+=this.el.playBtnBox.getWidth(),this.el.fullScreenBox.getVisible()&&(t=t-this.el.fullScreenBox.getWidth()-24,this.el.fullScreenBox.setX(t)),this.el.definition.getVisible()&&(t=t-this.el.definition.getWidth()-12,this.el.definition.setX(t)),this.el.volBox.getVisible()&&(t=t-this.el.volBox.getWidth()-12,this.el.volBox.setX(t)),t-=24,i+=12,this.el.playIngBar.setX(i),this.el.playIngBar.setWidth(t-i)},t.prototype.skinAction=function(t,e){switch(t){case b.DURATION:"live"==this.model.playType&&this.model.liveback&&this.el.playIngBar.setVisible(!0),this.duration=e.duration,this.el.duration.html(r.num2Time(this.duration));break;case b.TIME:"live"==this.model.playType&&this.model.liveback&&this.el.playIngBar.setVisible(!0),0<this.duration&&(this.playRate=e/this.duration,this.isSeeking||(this.el.playBar.setWidth(100*this.playRate+"%"),this.el.playBarIco.setX(100*this.playRate+"%"),this.el.time.html(r.num2Time(e))));break;case b.BUFFER:this.loadingRate=e,this.el.bufferBar.setWidth(100*this.loadingRate+"%");break;case b.CHANGESTATEPLAY:switch(e){case P.PLAY:this.el.playBtn.setVisible(!1),this.el.pauseBtn.setVisible(!0);break;case P.STOP:case P.PAUSE:this.el.playBtn.setVisible(!0),this.el.pauseBtn.setVisible(!1)}break;case b.DEFINITIONS:this.setUpDefinitionList(e);break;case b.DEFINITION:this.setUpDefinition(e);break;case b.CONTROLVISIBLE:e?this.skin.removeClassName("hCrtBar"):this.skin.addClassName("hCrtBar");break;case b.LOGO:this.setUpControlbarLogo(e)}},t.prototype.definitionListShow=function(t){var e=this;if(!(1>=e.elDeList.length)){clearTimeout(e.deTimeoutId),e.el.definitionList.setVisible(!0);var i=this.el.definition.getY()-this.el.definitionList.getHeight()-5,o=this.el.definition.getX()+.5*this.el.definition.getWidth()-.5*this.el.definitionList.getWidth();this.el.definitionList.setY(i),this.el.definitionList.setX(o),"undefined"!=typeof t&&"touchstart"==t.type&&(e.deTimeoutId=setTimeout(function(){e.el.definitionList.setVisible(!1)},5e3))}},t.prototype.definitionListHide=function(t){var e=this;1>=e.elDeList.length||(clearTimeout(e.deTimeoutId),t?e.deTimeoutId=setTimeout(function(){e.el.definitionList.setVisible(!1)},200):e.el.definitionList.setVisible(!1))},t.prototype.setUpDefinitionList=function(t){if(this.el.definitionList.html(""),this.elDeList=[],1>=t.length)this.el.definitionList.setVisible(!1);else for(var e=0;e<t.length;e++){var i=new V(l.$C("DIV"));i.setClassName("text button litem"),i.setAttribute({ratedata:t[e].rate}),i.html(t[e].name),this.elDeList.push(i),this.el.definitionList.appendChild(i),this.addDefinitionItemEvents(i)}},t.prototype.addDefinitionItemEvents=function(t){var e=this;t.addEventListener("click",function(){this.hasAttribute("checked")||(e.definitionListHide(!1),e.facade.dispatchEvent(new A(F.EVENT,F.SETDEFINITION,this.getAttribute("rateData"))))})},t.prototype.setUpDefinition=function(t){this.el.definition.html(t.name);for(var e=0;e<this.elDeList.length;e++){var i=this.elDeList[e];i.getAttribute("ratedata")==t.rate?(i.addClassName("activeText"),i.setAttribute({checked:1})):(i.removeClassName("activeText"),i.removeAttribute("checked"))}this.setSize.call(this,this.el.offsetWidth,this.el.offsetHeight)},t.prototype.setUpControlbarLogo=function(t){var e=this;if(e.logoInfo=t,e.el.logo.html(""),""!=e.logoInfo.pic){var i,o=l.$C("IMG");""!=e.logoInfo.url?(i=l.$C("A"),i.href=e.logoInfo.url,i.target="_blank",i.style.display="block",i.appendChild(o)):i=o,o.onload=function(){e.el.logo.appendChild(i),o.height>.9*e.el.offsetHeight&&(o.width=o.width*e.el.offsetHeight*.9/o.height,o.height=.9*e.el.offsetHeight),e.el.logo.setVisible(!0),e.setSize.call(e,e.el.offsetWidth,e.el.offsetHeight)},o.src=this.logoInfo.pic}},t}(),it=(function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,x),t.prototype.init=function(){this.tplKey="error",this.addEvent=!1},t.prototype.setUp=function(t){this.superClass.setUp.call(this,t,!0),this.skin.setVisible(!1)},t.prototype.skinAction=function(t,e){switch(t){case b.ERROR:this.skin.setVisible(!0);var i="",i=e.hasOwnProperty("message")&&""!=e.message?e.message:"播放失败了，不如刷新一下试试";this.el.message.html(i),this.el.errCode.html("<"+e.code+">"),i=.5*(this.el.offsetHeight-(this.el.message.getHeight()+this.el.errCode.getHeight())),this.el.message.setY(i),this.el.errCode.setY(i+this.el.message.getHeight());break;case b.ERRORHIDE:this.skin.setVisible(!1),this.el.message.html(""),this.el.errCode.html("")}},t}(),function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,x),t.prototype.init=function(){this.tplKey="loading",this.addEvent=!1},t.prototype.setUp=function(t){this.superClass.setUp.call(this,t,!0)},t.prototype.setSize=function(t,e,i){this.loading&&((this.loading.getWidth()>t||this.loading.getHeight()>e)&&(i=this.loading.getWidth()/this.loading.getHeight(),this.loading.getWidth()/this.loading.getHeight()>t/e?(this.loading.setWidth(parseInt(t)),this.loading.setHeight(parseInt(t/i))):(this.loading.setHeight(parseInt(e)),this.loading.setWidth(parseInt(e*i)))),this.loading.setStyle({marginLeft:-.5*this.loading.getWidth()+"px",marginTop:-.5*this.loading.getHeight()+"px"}))},t.prototype.skinAction=function(t,e,i){switch(t){case b.LOADING:var o=this;if(e.show){if(e.hasOwnProperty("type")&&0==e.type||""==e.url)o.el.bld.setVisible(!1),o.el.sld.setVisible(!0);else if(o.el.bld.setVisible(!0),o.el.sld.setVisible(!1),o.el.bld.getAttribute("url")!=e.url){o.el.bld.html(""),o.loading&&(o.loading.el.onload=null,o.loading=null);var s=l.$C("img");s.onload=function(){o.el.bld.html(""),o.loading=new V(s),o.el.bld.appendChild(this),o.el.bld.setAttribute({url:e.url}),o.setSize(o.skin.getWidth(),o.skin.getHeight()),this.onload=null},s.src=e.url}else o.setSize(o.skin.getWidth(),o.skin.getHeight());this.skin.setVisible(!0)}else this.skin.setVisible(!1)}},t}()),ot=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,x),t.prototype.init=function(){this.tplKey="playbtn",this.addEvent=!1},t.prototype.setUp=function(t){var e=this;e.superClass.setUp.call(this,t,!0),e.skin.setVisible(!1),e.skin.addEventListener("click",function(){e.facade.dispatchEvent(new A(F.EVENT,F.PLAY))})},t.prototype.setSize=function(t,e,i){},t.prototype.skinAction=function(t,e){switch(t){case b.CHANGESTATEPLAY:switch(e){case P.PLAY:this.skin.setVisible(!1);break;case P.STOP:case P.PAUSE:this.skin.setVisible(!0)}}},t}(),st=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,x),t.prototype.init=function(){this.superClass.init.apply(this,arguments),this.tplKey="skin",this.facade=new O},t.prototype.setUp=function(t){this.superClass.setUp.call(this,t),this.controlBar=new et(this.facade,this.model),this.controlBar.setUp(this.el.controlBar),this.loading=new it(this.facade,this.model),this.loading.setUp(this.el.loading),this.bigPlaybtn=new ot(this.facade,this.model),this.bigPlaybtn.setUp(this.el.playBtn)},t.prototype.skinHandler=function(t){this.dispatchEvent(t)},t.prototype.skinInit=function(t){this.skin.setVisible(!0),this.controlBar.skinAction(b.LOGO,r.clone(this.model.playerConfig.logo))},t.prototype.skinAction=function(t,e){this.controlBar.skinAction(t,e),this.loading.skinAction(t,e),this.bigPlaybtn.skinAction(t,e)},t.prototype.setSize=function(t,e){this.controlBar.setSize(this.controlBar.skin.getWidth(),this.controlBar.skin.getHeight()),this.loading.setSize(this.loading.skin.getWidth(),this.loading.skin.getHeight()),this.bigPlaybtn.setSize()},t}(),nt=function(){function t(t){this.model=t}return u.inherits(t,L),t.prototype.translate=function(){this.gslbLoader=new K(this.model),this.model.videoSetting.gslb?(this.gslbLoader.addEventListener(U.LOADCMP,this.gslbCmp,this),this.gslbLoader.addEventListener(U.LOADERROR,this.gslbErr,this),this.gslbLoader.load()):this.dispatchEvent(new A(U.LOADCMP,this.leUrlsHandler()))},t.prototype.gslbCmp=function(t){this.dispatchEvent(new A(U.LOADCMP,t.args[1]))},t.prototype.gslbErr=function(t){this.dispatchEvent(new A(U.LOADCMP,this.leUrlsHandler()))},t.prototype.leUrlsHandler=function(t){t=r.clone(this.model.videoSetting.urls);for(var e=0;e<t.length;e++)t[e]=this.gslbLoader.checkGslbUrl(t[e]);return t},t}(),rt=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,I),t.prototype.init=function(t,e){this.facade=t,this.model=e,this.model.record={},this.reportApi=new X(e),this.reportApi.onStateChanged("init",{deviceId:this.model.lc(),os:r.getOs(),osv:"-",width:window.screen.width,height:window.screen.height,appv:this.model.playerConfig.version})},t.prototype.setUp=function(t,e){this.model.videoSetting.errCode=0,this.facade.addEventListener(B.EVENT,this.videoSateHandler,this)},t.prototype.destroy=function(){this.superClass.destroy.apply(this,arguments),this.reportApi.reset(),this.facade.removeEventListener(B.EVENT,this.videoSateHandler,this)},t.prototype.videoSateHandler=function(t){switch(t.args[1]){case B.VIDEO_DATA_CMP:0!=this.model.record.ms&&(this.model.record.mr=r.now()-this.model.record.ms,this.model.record.ms=0),this.reportApi.onStateChanged("start",{});break;case _.BUFFEREMPTY:this.reportApi.onStateChanged("bufferEmpty");break;case _.BUFFEREFULL:this.reportApi.onStateChanged("bufferFull");break;case _.PLAY:this.reportApi.onStateChanged("resume");break;case _.START:0!=this.model.record.vs&&(this.model.record.pr=r.now()-this.model.record.vs,this.model.record.vs=0),this.reportApi.onStateChanged("play",{cv:{stc:{mr:this.model.record.mr,adr:this.model.record.adr,pr:this.model.record.pr,gslbr:this.model.record.gslbr},joint:this.model.joint}});break;case _.STOP:t.args[2]?this.reportApi.onStateChanged("playStop"):this.reportApi.onStateChanged("stopPlay");break;case _.PAUSE:this.reportApi.onStateChanged("pause");break;case _.SEEK:this.reportApi.onStateChanged("seek",{time:t.args[2]});break;case B.VPH:this.reportApi.onStateChanged("hide");break;case B.VPS:this.reportApi.onStateChanged("show");break;case _.DEFSTART:this.reportApi.onStateChanged("definition");break;case B.ERROR:case _.ERROR:t=t.args[2][0],this.model.videoSetting.errCode=t.code,this.reportApi.onStateChanged("error",{errcode:t.code}),this.report({logcontent:t.errInfo||""});break;case H.HEADEND:case H.NOAD:0!=this.model.record.as&&(this.model.record.adr=r.now()-this.model.record.as,this.model.record.as=0),this.model.record.vs=r.now();break;case B.VIDEO_DATA_START:this.model.record.ms=r.now();break;case B.GSLB_START:this.model.record.gslbs=r.now();break;case B.GSLB_CMP:0!=this.model.record.gslbs&&(this.model.record.gslbr=r.now()-this.model.record.gslbs,this.model.record.gslbs=0),this.model.record.vs=r.now()}},t.prototype.report=function(t){var e=this.model.videoSetting.errCode;t&&t.hasOwnProperty("code")&&(e=t.code);var i={ver:"1.0"};i.uuid=this.model.uuid(),i.ec=e,i.p3="h5",i.cvid="vod"==this.model.playType?this.model.videoSetting.vid:this.model.videoSetting.sid,i.vtyp=this.model.playType,i.mtyp="cloud",i.cuid=this.model.userData.userId,i.leid=this.model.lc(),i.pver=this.model.playerConfig.version,i.type=1,i.logcontent="";for(var o in t)i[o]=t[o];d.report("http://log.cdn.letvcloud.com/sdk/epl",i)},t.prototype.showLog=function(){d.print(p.getLog(),this.model.lc())},t.prototype.getLog=function(){return p.getLog()},t}(),at=function(){function t(){this.up=this.isvip=0,this.isTrylook=!1,this.pname="",this.ark=this.gdur=0}function e(){this.superClass.constructor.apply(this,arguments)}var i="http://yuntv.letv.com/player/plugin/adPlayer.js";return"https:"==window.location.protocol&&(i=i.replace("http://","https://s.")),u.inherits(e,I),e.prototype.setUp=function(t,e){var i=this;if(i.player=t,i.videoOutEl=e,i.model.config.hasOwnProperty("onPlayerReady"))if("function"!=typeof i.model.config.onPlayerReady&&(i.model.config.onPlayerReady=window[i.model.config.onPlayerReady]),"function"==typeof i.model.config.onPlayerReady)try{var o=setTimeout(function(){i.startLeAd.call(i)},5e3);i.model.config.onPlayerReady({video:i.player.player.video,el:this.videoOutEl},function(t,e){switch(t){case"adstart":clearTimeout(o);break;case"adend":i.startLeAd.call(i)}})}catch(s){i.startLeAd.call(i)}else i.startLeAd.call(i);else i.startLeAd.call(i)},e.prototype.startLeAd=function(){this.checkAd()?"undefined"==typeof H5AD||"function"!=typeof H5AD.initAD?r.getJS(i,this.initAd,this.initAd,this,"utf-8"):this.initAd():this.facade.dispatchEvent(new A(H.EVENT,H.NOAD,"skip"))},e.prototype.checkAd=function(){return!(this.model.config.hasOwnProperty("letvad")&&"0"==this.model.config.letvad.toString()||this.model.videoSetting.hasOwnProperty("ark")&&"0"==this.model.videoSetting.ark.toString())},e.prototype.initAd=function(i,o){function s(t,e){if(n.log(t),n.player)switch(t){case"playAD":n.adList=e,n.adList&&0==n.adList.length?setTimeout(function(){n.destroy(),n.facade.dispatchEvent(new A(H.EVENT,H.NOAD))},0):(n.curAdIndex=0,n.playAD(),n.facade.dispatchEvent(new A(H.EVENT,H.HEADSTART)));break;case"stopAD":setTimeout(function(){n.destroy(),n.facade.dispatchEvent(new A(H.EVENT,H.HEADEND))},0);break;case"resumeAD":n.videoPlay();break;case"pauseAD":n.videoPause();break;case"getCurrTime":return n.getTime()||0;case"getVideoRect":return n.getVideoRect()}}var n=this;if("undefined"!=typeof H5AD&&"function"==typeof H5AD.initAD){var r=new t;r.p1=this.model.reportParam.p1,r.p2=this.model.reportParam.p2,r.p3=this.model.reportParam.p2,r.lc=this.model.lc(),r.uuid=this.model.uuid(),r.ver=this.model.playerConfig.version,r.gdur=this.model.videoSetting.duration,r.cont=this.videoOutEl.id,"vod"==this.model.playType?(r.islive=!1,r.cid=this.model.videoSetting.cid,r.vid=this.model.videoSetting.vid,r.mmsid=this.model.videoSetting.mmsid,this.model.videoSetting.hasOwnProperty("pid")&&(r.pid=this.model.videoSetting.pid)):"live"==this.model.playType&&(r.islive=!0,r.sid=this.model.config.activityId),r.ch=this.model.getTypeFrom(),r.ark=this.model.videoSetting.ark,r.useui=1,this.model.videoSetting.hasOwnProperty("p")&&(r.ext=""==this.model.userData.userId?this.model.videoSetting.p:this.model.videoSetting.p+"|"+this.model.userData.userId),H5AD.initAD(r,s)}else this.facade.dispatchEvent(new A(H.EVENT,H.NOAD,"error"));e.prototype.playAD=function(){if(this.curAdIndex<this.adList.length){this.curAd=this.adList[this.curAdIndex],this.player.addEventListener(_.EVENT,this.mediaHandler,this);var t=!0;0==this.curAdIndex&&-2==this.model.config.posterType&&(t="1"==this.model.config.autoplay),this.player.startPlay({urls:[this.curAd.url]},0,t)}else this.destroy(),this.facade.dispatchEvent(new A(H.EVENT,H.HEADEND))},e.prototype.mediaHandler=function(t){switch(t.args[1]){case _.PLAY:H5AD.sendEvent("AD_PLAY",{curAD:this.curAd,curIndex:this.curAdIndex});break;case _.PAUSE:H5AD.sendEvent("AD_PAUSE",{curAD:this.curAd,curIndex:this.curAdIndex});break;case _.STOP:H5AD.sendEvent("AD_ENDED",{curAD:this.curAd,curIndex:this.curAdIndex}),this.curAdIndex++,H5AD.destory(this.curAd),this.playAD();break;case _.ERROR:H5AD.sendEvent("AD_ERROR",{curAD:this.curAd,curIndex:this.curAdIndex}),this.curAdIndex++,H5AD.destory(this.curAd),this.playAD()}},e.prototype.videoPlay=function(){this.player&&this.player.play()},e.prototype.getTime=function(){return this.player?this.player.getTime():0},e.prototype.videoPause=function(){this.player&&this.player.pause()},e.prototype.getVideoRect=function(){return this.player?this.player.getVideoRect():{w:0,h:0}},e.prototype.destroy=function(){this.player&&(this.player.removeEventListener(_.EVENT,this.mediaHandler,this),this.player.closeVideo(),this.player=null);try{H5AD&&this.curAd&&H5AD.destory(this.curAd)}catch(t){this.log("ad error "+t)}}},e}(),lt=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,I),t.prototype.setUp=function(t,e,i){t='<div id="#{video}" style="left:0px;top:0px;position: absolute;width:{width};height:{height};z-index:1;display: block;background-color: #000000;overflow:hidden"></div><div id="#{skin}" style="left:0px;top:0px;position: relative;width:{width};height:{height};z-index:2;overflow: hidden;"></div><div id="#{error}" style="left:0px;top:0px;position: absolute;width:{width};height:{height};z-index:3;overflow: hidden;display:none;"></div>'.replace(/{width}/g,"100%"),t=t.replace(/{height}/g,"100%"),this.el=l.$E(e),this.outEl=l.$E(i),this.setStylebyConfig(this.model.config),this.skin=new V(this.el),l.getTemplate(this.el,t),this.model.config.skinnable?(this.facade.addEventListener(B.EVENT,this.videoSateHandler,this),this.skinView=new st(this.facade,this.model),this.skinView.addEventListener(F.EVENT,this.skinHandler,this),this.skinView.setUp(this.el.skin),this.skinView.skinAction(b.CONTROLVISIBLE,!1),this.skinView.skin.setVisible(!1)):this.el.removeChild(this.el.skin)},t.prototype.setStylebyConfig=function(t){var e=["controls","fullscreen"],i="vb"+r.creatUuid();this.el.className=i;for(var o=0;o<e.length;o++)t[e[o]]||(t.pageControls?g["setMedia"+e[o]]("",!1):g["setMedia"+e[o]](i,!1))},t.prototype.getVideArea=function(){return this.el.skin.videoArea||null},t.prototype.autoSize=function(){var t=this.model.videoSetting.videoWidth,e=this.model.videoSetting.videoHeight;if(0!=t&&0!=e)switch(t/=e,this.model.config.autoSize){case"1":e=l.$E(this.el).offsetWidth,this.log("获得容器的宽度=============================="+e),0==e&&(e=l.$E(this.outEl).style.width,e=-1==e.indexOf("%")?parseInt(e):0),this.log("获得容器的宽度=============================="+e),e>0&&(this.model.config.changeParent&&(this.outEl.style.height=e/t+"px"),this.el.style.height=e/t+"px");break;case"2":e=l.$E(this.el).offsetHeight,0==e&&(e=l.$E(this.outEl).style.height,e=-1==e.indexOf("%")?parseInt(e):0),e>0&&(this.model.config.changeParent&&(this.outEl.style.width=e*t+"px"),this.el.style.width=e*t+"px")}},t.prototype.setSize=function(){0<this.el.offsetWidth&&0<this.el.offsetHeight?(this.display=!0,this.skinView&&this.skinView.setSize()):this.display=!1},t.prototype.addEvents=function(){this.skinView&&(this.hideFun=r.bindFun(this.autoHide,this),this.showFun=r.bindFun(this.autoShow,this),this.skinView.skin.addEventListener("mouseout",this.hideFun),this.skinView.skin.addEventListener("mouseover",this.showFun))},t.prototype.removeEvents=function(){this.skinView&&this.hideFun&&this.showFun&&(this.skinView.skin.removeEventListener("mouseout",this.hideFun),
this.skinView.skin.removeEventListener("mouseover",this.showFun))},t.prototype.autoHide=function(t){this.skinView&&(this.timer&&this.timer.reset(),this.skinView.skinAction(b.CONTROLVISIBLE,!1))},t.prototype.autoShow=function(t){this.skinView&&(this.skinView.skinAction(b.CONTROLVISIBLE,!0),"undefined"==typeof t||"mouseover"!=t.type)&&(this.timer?this.timer.reset():this.timer=new N(5e3,this,this.autoHide,1),this.timer.start())},t.prototype.destroy=function(){this.shutDown(),this.skinView&&(this.facade.removeEventListener(B.EVENT,this.videoSateHandler,this),this.skinView.removeEventListener(F.EVENT,this.skinHandler,this),this.removeEvents(),this.skinView=null)},t.prototype.skinHandler=function(t){this.facade.dispatchEvent(t)},t.prototype.shutDown=function(){this.skinView&&(this.skinView.skinAction(b.BUFFER,0),this.skinView.skinAction(b.TIME,0),this.skinView.skinAction(b.LOADING,{show:!1}),this.skinView.skinAction(b.CONTROLVISIBLE,!1),this.skinView.skin.setVisible(!1),this.removeEvents())},t.prototype.videoSateHandler=function(t){switch(t.args[1]!==_.LODING&&t.args[1]!=_.PLAYING&&this.log(t.args[1]),t.args[1]){case _.SEEKEMPTY:case _.BUFFEREMPTY:this.skinView.skinAction(b.LOADING,{show:!0,url:this.model.playerConfig.loadingUrl,type:"0"});break;case _.BUFFEREFULL:this.skinView.skinAction(b.LOADING,{show:!1});break;case _.START:this.skinView.skinAction(b.LOADING,{show:!1}),this.addEvents(),this.autoShow(),this.model.config.onlyPic&&this.skinView.skinAction(b.CHANGESTATEPLAY,P.PAUSE);break;case _.PLAY:this.model.config.onlyPic||this.skinView.skinAction(b.CHANGESTATEPLAY,P.PLAY);break;case _.STOP:this.skinView.skinAction(b.LOADING,!1),this.skinView.skinAction(b.CHANGESTATEPLAY,P.STOP),this.autoShow(),this.timer.stop();break;case _.PAUSE:this.skinView.skinAction(b.CHANGESTATEPLAY,P.PAUSE),this.autoShow();break;case _.SEEK:this.skinView.skinAction(b.TIME,t.args[2]),this.autoShow();break;case _.PLAYING:this.skinView.skinAction(b.TIME,t.args[2]),this.display||this.facade.dispatchEvent(new A(B.EVENT,B.PRESIZE));break;case _.DURATION:case _.METADATA:this.skinView.skinAction(b.DURATION,t.args[2]);break;case _.LODING:this.skinView.skinAction(b.BUFFER,t.args[2]);break;case _.ERROR:case B.ERROR:case B.VIDEO_INFO:this.skinView.skin.setVisible(!0),this.skinView.skinAction(b.LOADING,{show:!1,url:this.model.playerConfig.mloadingUrl}),this.autoHide();break;case H.HEADSTART:this.skinView.skinAction(b.LOADING,{show:!1,url:this.model.playerConfig.mloadingUrl});break;case _.CONNECT:this.skinView.skinInit(),this.skinView.skinAction(b.LOADING,{show:!0,url:this.model.playerConfig.mloadingUrl}),this.skinView.skinAction(b.DEFINITIONS,this.getDefinitionList()),this.skinView.skinAction(b.DEFINITION,this.getDefinition()),this.autoHide();break;case _.DEFSTART:this.skinView.skinAction(b.LOADING,{show:!0,url:this.model.playerConfig.loadingUrl,type:"0"}),this.skinView.skinAction(b.DEFINITION,this.getDefinition());break;case B.VIDEO_AUTH_VALID:this.skinView.skin.setVisible(!1);break;case B.PRESIZE:this.setSize()}},t.prototype.getDefinition=function(){var t={},e=this.model.videoSetting;return t.rate=e.definition,t.name=e.media[t.rate].definition,t},t.prototype.getDefinitionList=function(){for(var t=[],e=this.model.videoSetting,i=0;i<e.definitionList.length;i++){var o={};o.rate=e.definitionList[i],o.name=e.media[o.rate].definition,t.push(o)}return t},t.prototype.setVideoPercent=function(t){},t.prototype.setVideoScale=function(t){},t.prototype.setVideoRect=function(t){},t}(),ht=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,I),t.prototype.setUp=function(t,e){this.log("开始创建视频模块"),this.el=e,this.mediaPlayer=new tt(this.getConfig()),this.model.videoSetting.volume=.8,this.model.videoSetting.fullscreen=!1,this.setDefinitionList(),this.getDefaultConfig(this.model.config),this.changeVideoInfo(this.definition),this.mediaPlayer.setUp(this.model.videoSetting,e),this.facade.dispatchEvent(new A(B.EVENT,B.INIT))},t.prototype.getConfig=function(t){switch(t=r.clone(this.model.config),t.posterType){case"-1":case"-2":break;default:t.autoplay="1",t.pic=""}return t},t.prototype.changeVideoInfo=function(t){this.videoInfo=r.clone(this.model.videoSetting.media[t]),this.videoInfo.definitionName=this.videoInfo.definition,this.videoInfo.definition=t,t={uuid:this.model.uuid(),p1:this.model.reportParam.p1,p2:this.model.reportParam.p2,p3:this.model.reportParam.p3},this.model.videoSetting.hasOwnProperty("liveId")&&(t.liveid=this.model.videoSetting.liveId,this.videoInfo.lid=this.model.videoSetting.liveId),this.model.videoSetting.hasOwnProperty("vid")&&(t.vid=this.model.videoSetting.vid),t.ajax=1,r.addUrlParams(this.videoInfo.urls,t),this.model.videoSetting.refresh(this.videoInfo)},t.prototype.setDefinitionList=function(){var t,e=[];for(t in this.model.videoSetting.media)e.push(t);e.sort(function(t,e){return defaultDefinitionList.indexOf(e)-defaultDefinitionList.indexOf(t)}),this.model.videoSetting.refresh({definitionList:e})},t.prototype.getDefaultConfig=function(t){this.definition=this.model.videoSetting.defaultDefinition||this.model.videoSetting.definitionList[0],t.hasOwnProperty("rate")&&-1!=this.model.videoSetting.definitionList.indexOf(t.rate)&&(this.definition=t.rate),this.startime=0,t.hasOwnProperty("start")&&(this.startime=t.start)},t.prototype.setSize=function(t,e,i){this.mediaPlayer.setSize()},t.prototype.showPoster=function(t){var e=this;switch(e.hidePoster(),e.poster=null,e.mediaPlayer.hide(!1),this.model.config.posterType){case"-2":case"-1":e.mediaPlayer.show();break;case"0":break;default:e.addPoster()}-2==this.model.config.posterType?(this.mediaPlayer.setPoster(this.model.videoSetting.pic),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_AUTH_VALID))):(this.model.config.skinnable||this.model.config.controls)&&(e.playBtn=l.$C("DIV"),e.playBtn.style.cssText="position:absolute;width:75px;height:75px;left:50%;top:50%;background:rgba(1, 1, 1, 0) url(http://yuntv.letv.com/assets/img/skin.png?v=1901) no-repeat -111px -101px;margin: -40px 0 0 -38px;z-index:2;cursor:pointer;",e.el.appendChild(e.playBtn),l.addEvent(e.playBtn,"click",function(t){e.startAuth.call(e)}))},t.prototype.addPoster=function(t){this.poster?this.poster.style.display="":(this.poster=l.$C("DIV"),this.model.config.hasOwnProperty("pic")?this.poster.src=this.model.config.pic:this.poster.src=this.model.videoSetting.pic,this.poster.style.cssText="position:absolute;width:100%;height:100%; top: 0px;left: 0px;background:rgba(1, 1, 1, 0) url("+this.poster.src+") no-repeat 50% 50%;background-size:"+["","contain","cover","100% 100%"][this.model.config.posterType]+";z-index:2;cursor:pointer;"),this.el.appendChild(this.poster)},t.prototype.hidePoster=function(t){this.poster&&this.el&&this.poster.parentNode==this.el&&(this.el.removeChild(this.poster),this.poster=null),this.playBtn&&this.el&&this.playBtn.parentNode==this.el&&(this.el.removeChild(this.playBtn),this.playBtn=null)},t.prototype.startAuth=function(t){this.hidePoster(),this.model.config.onlyPic?this.mediaPlayer.hide():this.mediaPlayer.show(),this.mediaPlayer.play(),0>this.model.config.posterType+0?this.mediaPlayer.setPoster(this.model.videoSetting.pic):this.mediaPlayer.setPoster(""),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_AUTH_VALID))},t.prototype.startPlay=function(t){this.log("开始尝试播放"),this.isStartPlay=!1,this.setDefinitionList(),this.getDefaultConfig(this.model.config),this.mediaPlayer.addEventListener(_.EVENT,this.mediaHandler,this),this.facade.addEventListener(F.EVENT,this.skinSateHandler,this),this.facade.addEventListener(B.EVENT,this.videoSateHandler,this),this.mediaPlayer.setContainer(t),this.mediaPlayer.setLoop(this.model.config.loop),this.playVideo(this.start),this.facade.dispatchEvent(new A(B.EVENT,_.CONNECT))},t.prototype.startGslb=function(t){this.gslbplayTime=t,this.gslbLoader=new nt(this.model),this.gslbLoader.addEventListener(U.LOADCMP,this.gslbCmp,this),this.gslbLoader.addEventListener(U.LOADERROR,this.gslbErr,this),this.gslbLoader.translate(),this.facade.dispatchEvent(new A(B.EVENT,B.GSLB_START))},t.prototype.gslbCmp=function(t){var e=this;e.videoInfo.urls=t.args[1];var i=!0;0!=e.model.joint||e.isStartPlay||-2!=e.model.config.posterType||(i="1"==e.model.config.autoplay),e.model.config.onlyPic?(e.mediaPlayer.show(),setTimeout(function(){e.mediaPlayer.startPlay(e.videoInfo,e.gslbplayTime,i,e.getPlayerType())},10)):e.mediaPlayer.startPlay(e.videoInfo,e.gslbplayTime,i,e.getPlayerType()),e.facade.dispatchEvent(new A(B.EVENT,B.GSLB_CMP))},t.prototype.gslbErr=function(t){this.facade.dispatchEvent(new A(B.EVENT,B.ERROR,t.args[2]))},t.prototype.setAutoReplay=function(t){this.mediaPlayer.setLoop(t)},t.prototype.setDefinition=function(t){this.definition!=t&&-1!=this.model.videoSetting.definitionList.indexOf(t)&&(this.log("切换码流-----------------------------"+t),this.definition=t,this.isStartPlay=!1,this.playVideo(this.mediaPlayer.getTime()),this.facade.dispatchEvent(new A(B.EVENT,_.DEFSTART)))},t.prototype.playVideo=function(t){"pano"!=this.getPlayerType()||r.checkPano()?(this.changeVideoInfo(this.definition),this.mediaPlayer.getVideoEl()&&this.mediaPlayer.getVideoEl().setAttribute("data-rate",s(this.model.videoSetting.definition)),this.startGslb(t)):this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_INFO,[{code:490,message:"该设备还不支持3d功能,建议使用windows和安卓系统下的谷歌浏览器体验该功能"}]))},t.prototype.getDefinitionList=function(){return this.model.videoSetting.definitionList},t.prototype.videoSateHandler=function(t){switch(t.args[1]){case B.VPH:this.isStartPlay&&this.mediaPlayer.pause();break;case _.START:this.isStartPlay=!0,this.mediaPlayer.show(),this.model.config.onlyPic&&this.addPoster();break;case _.STOP:this.isStartPlay=!1;break;case B.ERROR:case _.ERROR:this.isStartPlay=!1;case B.VIDEO_INFO:this.model.config.skinnable&&this.mediaPlayer.hide(!1);break;case B.FULLSCREEN:this.model.config.onlyPic&&!this.model.videoSetting.fullscreen&&this.mediaPlayer.hide();break;case B.PRESIZE:this.setSize()}},t.prototype.skinSateHandler=function(t){switch(t.args[1]){case F.PLAY:if(this.model.config.onlyPic){var e=this;e.mediaPlayer.show(),setTimeout(function(){e.mediaPlayer.play()},10)}else this.mediaPlayer.play();break;case F.PAUSE:this.mediaPlayer.pause();break;case F.SEEK:this.mediaPlayer.seek(t.args[2]);break;case F.VOLUME:this.model.videoSetting.volume=t.args[2],this.mediaPlayer.setVol(this.model.videoSetting.volume);break;case F.SETDEFINITION:this.setDefinition(t.args[2]);break;case F.REPLAY:this.mediaPlayer.replay()}},t.prototype.getPlayerType=function(){return this.model.config.hasOwnProperty("pano")&&"1"==this.model.config.pano||"1"==this.model.videoSetting.pano?"pano":""},t.prototype.mediaHandler=function(t){switch(t.args[1]){case _.ERROR:if("vod"==this.model.playType&&this.model.vodPlayType&&"ios"==this.model.vodPlayType&&t.args[2][0].retryCdn)return this.model.vodPlayType="mp4",r.setLocal("playType",this.model.vodPlayType),this.log("重新调度"),void this.startGslb(0)}this.facade.dispatchEvent(new A(B.EVENT,t.args[1],t.args[2]))},t.prototype.destroy=function(t){this.facade.removeEventListener(F.EVENT,this.skinSateHandler,this),this.facade.removeEventListener(B.EVENT,this.videoSateHandler,this),this.mediaPlayer.removeEventListener(_.EVENT,this.mediaHandler,this),this.mediaPlayer.destroy(),this.facade.dispatchEvent(new A(B.EVENT,_.STOP,!1))},t}(),dt=function(){function e(){this.superClass.constructor.apply(this,arguments)}return u.inherits(e,I),e.prototype.setUp=function(t){this.player=t,this.addEvents()},e.prototype.addEvents=function(){var e=this;e.addVideoEvent=!1,e.facade.addEventListener(F.EVENT,e.skinSateHandler,e),e.facade.addEventListener(B.EVENT,e.videoSateHandler,e),e.fullChangeFun=r.bindFun(e.fullChange,e),e.resizeFun=r.bindFun(e.resize,e),l.addEvent(t,"fullscreenchange,webkitfullscreenchange,mozfullscreenchange,MSFullscreenChange",e.fullChangeFun),l.addEvent(window,"resize",this.resizeFun),l.addEvent(window,"pagehide",r.bindFun(this.pageHide,this));var i;["webkit","moz","o","ms"].forEach(function(e){"undefined"!=typeof t[e+"Hidden"]&&(i=e)}),l.addEvent(t,i+"visibilitychange",function(){"hidden"==t[i+"VisibilityState"]?e.facade.dispatchEvent(new A(B.EVENT,B.VPH)):"visible"==t[i+"VisibilityState"]&&e.facade.dispatchEvent(new A(B.EVENT,B.VPS))})},e.prototype.videoSateHandler=function(t){switch(t.args[1]){case B.INIT:this.addVideoEvents()}},e.prototype.pageHide=function(t){this.facade.dispatchEvent(new A(B.EVENT,B.WPH))},e.prototype.fullChange=function(){this.model.videoSetting&&(this.model.videoSetting.fullscreen=l.isFullScreen(),this.model.videoSetting.fullscreen||(this.cancelFullscreen(),this.resizeFun()),this.facade.dispatchEvent(new A(B.EVENT,B.FULLSCREEN,this.model.videoSetting.fullscreen)))},e.prototype.resize=function(){this.facade.dispatchEvent(new A(B.EVENT,B.PRESIZE))},e.prototype.cancelFullscreen=function(){var e=this.player.skinplugin.skin;e.hasAttribute("tmpStyle")&&(e.setStyle({cssText:e.getAttribute("tmpStyle")}),e.removeAttribute("tmpStyle")),this.bodyTmpOverFlow&&(t.body.style.overflow=this.bodyTmpOverFlow)},e.prototype.addVideoEvents=function(t){t=this.player.videoplugin.mediaPlayer.getVideoEl();var e=this;e.addVideoEvent||(t.addEventListener("webkitbeginfullscreen",function(){e.model.videoSetting.fullscreen=!0,e.facade.dispatchEvent(new A(B.EVENT,B.FULLSCREEN,e.model.videoSetting.fullscreen))}),t.addEventListener("webkitendfullscreen",function(){e.model.videoSetting.fullscreen=!1,e.facade.dispatchEvent(new A(B.EVENT,B.FULLSCREEN,e.model.videoSetting.fullscreen)),e.resizeFun()}),e.addVideoEvent=!0)},e.prototype.skinSateHandler=function(e){switch(e.args[1]){case F.FULLSCREEN:if(e=this.player.videoplugin.mediaPlayer.getVideoEl(),this.model.config.dfull&&e&&e.webkitEnterFullscreen&&"chrome"!=r.getBrowser()){e.webkitEnterFullscreen();break}this.model.videoSetting.fullscreen?(this.model.videoSetting.fullscreen=!1,this.cancelFullscreen(),l.supportFullScreen()&&this.model.config.dfull&&l.cancelFullScreen()):(this.model.videoSetting.fullscreen=!0,this.player.skinplugin.skin.setAttribute({tmpStyle:this.player.skinplugin.el.style.cssText}),l.supportFullScreen()&&this.model.config.dfull?l.fullScreen(this.player.skinplugin.el):(this.bodyTmpOverFlow=t.body.style.overflow,t.body.style.overflow="hidden"),this.player.skinplugin.skin.setStyle({cssText:"background: #000;width:100%;height:100%;position:fixed;top:0;left:0;z-index:1000;overflow:hidden;"})),this.resizeFun()}},e}(),pt=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,I),t.prototype.setUp=function(t,e,i){this.el=e,this._api=i,this.skin=new V(this.el),this.playingStop=!1,this.error=null,this.facade.addEventListener(B.EVENT,this.videoSateHandler,this)},t.prototype.videoSateHandler=function(t){var e=this;switch(t.args[1]){case _.START:case _.BUFFEREFULL:this.skin.setVisible(!1);break;case _.ERROR:case B.ERROR:case B.VIDEO_INFO:if(this.skin.setVisible(!0),!this.model.config.skinnable)break;e.error?e.error.show(t.args[2],e.el,{api:e._api,model:e.model}):n.getPlugin("ErrorInfo",function(i){i&&(e.error=new i,e.error.show(t.args[2],e.el,{api:e._api,model:e.model}))});break;case _.STOP:this.playingStop=!0,this.skin.setVisible(!1);break;case _.PLAYING:this.playingStop&&this.skin.setVisible(!1),this.playingStop=!1;break;case B.VIDEO_LIVESTOP:this.playingStop=!0}},t.prototype.report=function(){},t}(),ct=function(){function t(t,e,i){"undefined"!=typeof i.api[t]&&(e[t]=function(){return i.api[t].apply(i.api,arguments)})}return function(e){for(var i=0;i<T.length;i++)t(T[i],this,e)}}(),ut=function(){function t(t,i,o){e.prototype[t]=function(){return o[t].apply(o,arguments)}}function e(i){for(this.player=i,i=0;i<T.length;i++)t(T[i],e,this.player.plugin);e.prototype.playNewId=function(t){return this.player.plugin.setLejuData(t)},e.prototype.callFlash=function(t){return this.player.plugin[t.action](t.value)}}return e}(),ft=function(){function t(t){this._pl=t}return t.prototype.playNewId=function(t){return this._pl.playNewId(t)},t.prototype.getVideoSetting=function(){for(var t=r.clone(this._pl.model.videoSetting),e={},i=0;i<m.length;i++){var o=m[i];t.hasOwnProperty(o)?e[o]="definition"==o?this.getDefinition():"defaultDefinition"==o?this.getDefaultDefinition():t[o]:e[o]=""}return e},t.prototype.getVideoTime=function(){return this._pl.videoplugin?this._pl.videoplugin.mediaPlayer.getTime():0},t.prototype.pauseVideo=function(){this._pl.facade.dispatchEvent(new A(F.EVENT,F.PAUSE))},t.prototype.resumeVideo=function(){this._pl.facade.dispatchEvent(new A(F.EVENT,F.PLAY))},t.prototype.seekTo=function(t){this._pl.facade.dispatchEvent(new A(F.EVENT,F.SEEK,t))},t.prototype.replayVideo=function(){this._pl.facade.dispatchEvent(new A(F.EVENT,F.REPLAY))},t.prototype.closeVideo=function(){this._pl.closeVideo()},t.prototype.setVolume=function(t){this._pl.facade.dispatchEvent(new A(F.EVENT,F.VOLUME,t))},t.prototype.shutDown=function(){this._pl.shutDown()},t.prototype.startUp=function(){this._pl.startUp()},t.prototype.getBufferPercent=function(){return this._pl.videoplugin?this._pl.videoplugin.mediaPlayer.getBufferPercent():0},t.prototype.setDefinition=function(t){t=o(t),this._pl.facade.dispatchEvent(new A(F.EVENT,F.SETDEFINITION,t))},t.prototype.getDefinition=function(){return s(this._pl.model.videoSetting.definition)},t.prototype.getDefaultDefinition=function(){return s(this._pl.model.videoSetting.defaultDefinition)},t.prototype.getDefinitionList=function(){for(var t=[],e=0;e<this._pl.model.videoSetting.definitionList.length;e++){var i=s(this._pl.model.videoSetting.definitionList[e]);t.push(i)}return t},t.prototype.setVideoPercent=function(t){this._pl.skinplugin.setVideoPercent(t)},t.prototype.getVideoPercent=function(){},t.prototype.setVideoScale=function(t){return this._pl.skinplugin.setVideoScale(t),0},t.prototype.getVideoScale=function(){return 0},t.prototype.resetVideoScale=function(){return this._pl.skinplugin.setVideoScale(0),0},t.prototype.fullVideoScale=function(){this._pl.skinplugin.setVideoScale(1)},t.prototype.setVideoRect=function(t){this._pl.skinplugin.setVideoScale(t)},t.prototype.getLoadPercent=function(){return this._pl.videoplugin?this._pl.videoplugin.mediaPlayer.getLoadPercent():void 0},t.prototype.getDownloadSpeed=function(){return 0},t.prototype.getPlayRecord=function(){return this._pl.videoplugin?this._pl.videoplugin.getPlayRecord():void 0},t.prototype.getPlayState=function(){return this._pl.videoplugin?this._pl.videoplugin.getPlayState():void 0},t.prototype.setVideoColor=function(){return-1},t.prototype.getVideoColor=function(){return-1},t.prototype.getVersion=function(){return this._pl.version},t.prototype.setAutoReplay=function(t){return this._pl.videoplugin.setAutoReplay(t)},t.prototype.feedback=function(t){return this._pl.feedback(t)},t.prototype.getLog=function(t){return this._pl.getLog(t)},t.prototype.getServerTime=function(t){},t}(),yt={configConver:function(t){var e={dfull:!0,fullscreen:!0,skinnable:!0,controls:!1,loop:!1,definition:!0,autoSize:"0",changeParent:!1,posterType:"1",playsinline:"1",autoplay:"0",onlyPic:!1,playIngBg:!1,dvideoSize:!0,mustAutoplay:!1,pageControls:!1};0>parseInt(t.posterType)&&!t.hasOwnProperty("controls")&&!t.hasOwnProperty("skinnable")&&(t.controls="1",t.skinnable="0");for(var i in e)t.hasOwnProperty(i)?"boolean"==typeof e[i]&&(t[i]="1"==t[i]):t[i]=e[i];switch(t.hasOwnProperty("pa")&&(t.pano=t.pa,delete t.pa),t.hasOwnProperty("auto_play")&&(t.autoplay=t.auto_play,delete t.auto_play),t.hasOwnProperty("autoReplay")&&(t.loop="1"==t.autoReplay,delete t.autoReplay),(1<parseInt(t.autoplay)||0>parseInt(t.autoplay))&&(t.autoplay="0"),(3<parseInt(t.posterType)||-2>parseInt(t.posterType))&&(t.posterType="1"),t.autoplay+="",t.posterType+="",t.hasOwnProperty("rate")&&(t.rate=o(t.rate)),t.onlyPic=!1,t.playIngBg=!0,r.getDevice()){case"androidPhone":case"androidPad":case"android":switch(r.getBrowser()){case"uc":t.skinnable=!1,t.controls=!0;break;default:t.mustAutoplay||(t.autoplay="0")}break;case"iphone":switch(r.getBrowser()){case"uc":t.dfull=!1;break;case"qq":t.onlyPic=!0;break;default:var e=navigator.userAgent.toLowerCase(),s=[/cpu iphone os 8_/];for(i=0;i<s.length;i++)if(s[i].test(e)){t.dvideoSize=!1;break}if(0<=parseInt(t.posterType)&&(s=[/cpu iphone os 7_/,/cpu iphone os 6_/],t.skinnable))for(i=0;i<s.length;i++)if(s[i].test(e)){t.onlyPic=!0;break}}case"ipad":switch(r.getBrowser()){case"qqwebview":case"weixin":e=navigator.userAgent.toLowerCase(),/cpu iphone os 8_/.test(e)&&!t.mustAutoplay&&(t.autoplay="0");break;default:t.mustAutoplay||(t.autoplay="0")}break;case"pc":t.playIngBg=!1}}},gt=function(){function t(){this.init()}return u.inherits(t,L),t.prototype.init=function(){this.api=new ft(this)},t.prototype.setUp=function(t,e,i){this.vModelInit=this.canplay=!1,this.model=new M,this.setModelType(),this.model.api=this.getVideoApi(),this.configHanlder(t),this.model.config.refresh(t),this.model.playerConfig.refresh({version:this.version}),this.facade=new O,this.skinplugin=new lt(this.facade,this.model),this.skinplugin.setUp(t,e,i),this.reportplugin=new rt(this.facade,this.model),this.reportplugin.setUp(),this.globalplugin=new dt(this.facade,this.model),this.globalplugin.setUp(this),this.errorplugin=new pt(this.facade,this.model),this.errorplugin.setUp(this,this.skinplugin.el.error,this.api),this.addEvents(),this.envCheck()&&this.startGetData()},t.prototype.envCheck=function(){return"1"!=this.model.config.pano||r.checkPano()?!0:(this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_INFO,[{code:490,message:"该设备还不支持3d功能,建议使用window或安卓系统下的谷歌浏览器体验该功能"}])),!1)},t.prototype.setModelType=function(){},t.prototype.configHanlder=function(t){yt.configConver(t)},t.prototype.addEvents=function(){this.facade.addEventListener(F.EVENT,this.skinHandler,this),this.facade.addEventListener(B.EVENT,this.videoHandler,this)},t.prototype.removedEvents=function(){this.facade.removeEventListener(F.EVENT,this.skinHandler,this),this.facade.removeEventListener(B.EVENT,this.videoHandler,this)},t.prototype.startGetData=function(){this.log("开始请求数据"),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_DATA_START))},t.prototype.dataCmp=function(){this.log("请求GpC成功"),"0"==this.model.videoSetting.isdrm?(this.setupPlayer(),this.vModelInit=!0,"0"==this.model.config.autoplay?this.videoplugin.showPoster():this.videoplugin.startAuth(),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_DATA_CMP))):this.facade.dispatchEvent(new A(B.EVENT,B.ERROR,[{code:k.VOD_CONFIG_DRM,message:"视频为加密视频，无法解密播放"}]))},t.prototype.setupPlayer=function(){this.log("开始创建播放器"),this.videoplugin||(this.videoplugin=new ht(this.facade,this.model),this.videoplugin.setUp(this.model.videoSetting,this.skinplugin.el.video))},t.prototype.creatVideo=function(){this.log("开始创建视频"),this.videoplugin.startPlay(this.skinplugin.getVideArea())},t.prototype.setupAdplugin=function(){this.model.record.as=r.now(),this.log("开始请求广告"),this.adplugin=new at(this.facade,this.model),this.facade.addEventListener(H.EVENT,this.adHandler,this),this.adplugin.setUp(this.videoplugin.mediaPlayer,this.skinplugin.el)},t.prototype.errorHanlder=function(t){this.log("数据请求失败"),this.facade.dispatchEvent(new A(B.EVENT,B.ERROR,t.args[1]))},t.prototype.adHandler=function(t){switch(this.log("广告返回"+t.args[1]),t.args[1]){case H.HEADSTART:this.model.joint=2,this.facade.dispatchEvent(new A(B.EVENT,H.HEADSTART));break;case H.HEADEND:this.model.joint=2;case H.NOAD:this.model.joint=0,this.facade.removeEventListener(H.EVENT,this.adHandler,this),this.facade.dispatchEvent(new A(B.EVENT,t.args[1],t.args[2])),this.creatVideo()}},t.prototype.videoHandler=function(t){if(this.vStateHandler(t)){switch(t.args[1]){case B.VIDEO_AUTH_VALID:this.canplay=!0,this.setupAdplugin();break;case B.INIT:"0"!=this.model.config.autoSize&&this.skinplugin.autoSize();break;case B.VIDEO_DATA_START:case B.GSLB_START:case B.GSLB_CMP:case B.VIDEO_DATA_CMP:case _.PLAYING:case _.LODING:return;case B.WPH:return void this.destroy()}if(this.model.config.hasOwnProperty("callbackJs")){var e=t.args[1];t=t.args[2],e==B.ERROR&&(e=_.ERROR),w[this.model.config.callbackJs]&&w[this.model.config.callbackJs](e,t)}}},t.prototype.vStateHandler=function(t){},t.prototype.skinHandler=function(t){},t.prototype.destroy=function(){this.skinplugin&&this.skinplugin.shutDown(),this.globalplugin&&this.globalplugin.destroy(),this.videoplugin&&this.videoplugin.destroy(),this.removedEvents(),this.vModel&&(this.vModel.destroy(),this.vModel=null),this.adplugin&&(this.adplugin.destroy(),this.adplugin=null),this.reportplugin&&this.reportplugin.destroy()},t.prototype.closeVideo=function(){this.videoplugin.destroy()},t.prototype.shutDown=function(){this.destroy(),this.addEvents(),this.videoplugin&&this.videoplugin.showPoster()},t.prototype.startUp=function(){this.log("call startUp -vModelInit:"+this.vModelInit),this.destroy(),this.vModelInit?(this.reportplugin.setUp(),this.addEvents(),this.videoplugin&&this.videoplugin.startAuth()):(this.model.config.autoplay="1",this.reportplugin.setUp(),this.addEvents(),this.startGetData())},t.prototype.playNewId=function(t){var e="";this.destroy(),this.model.clear(),this.setModelType(),this.model.playerConfig.refresh({version:this.version}),this.model.init({deviceId:this.model.lc(),os:r.getOs(),osv:"-",width:window.screen.width,height:window.screen.height,appv:this.version}),this.vModelInit=!1,this.canplay&&!t.hasOwnProperty("autoplay")&&(e="1"),this.configHanlder(t),""!=e&&(t.autoplay=e),this.model.config.refresh(t),this.reportplugin.setUp(),this.addEvents(),this.startGetData()},t.prototype.feedback=function(t){"undefined"==typeof t&&(t={}),t.type="0",t.logcontent=api.getLog(),this.reportplugin.report(t)},t.prototype.getLog=function(){return this.reportplugin.getLog()},t.prototype.getVideoApi=function(){var t=this;return{getVideoInfo:function(){return{time:t.videoplugin.mediaPlayer.getTime()}}}},t}(),mt=function(){function t(){this.superClass.constructor.apply(this,arguments)}return u.inherits(t,gt),t.prototype.init=function(){this.superClass.init.apply(this,arguments),this.version="H5_Live_20160425_4.2.0",this.errCheck=null,this.checkTimer=new N(3e3,this,this.checkHanlder,1)},t.prototype.setUp=function(t,e,i){t.hasOwnProperty("domain")||(t.domain=w.location.host||S.domain),this.superClass.setUp.apply(this,arguments)},t.prototype.setModelType=function(){this.model.playType="live",this.model.videoSetting.gslb=!1},t.prototype.startGetData=function(){this.superClass.startGetData.apply(this,arguments),this.vModel=new $(this.model),this.vModel.addEventListener(U.LOADCMP,this.dataCmp,this),this.vModel.addEventListener(U.LOADERROR,this.errorHanlder,this),this.vModel.setUp(this.model.config,this.skinplugin)},t.prototype.vStateHandler=function(t){if(this.model.liveback)return!0;switch(t.args[1]){case _.PLAYING:this.removeCheck(),this.checkTimer.reset(),this.checkTimer.start();break;case _.PAUSE:case _.STOP:this.removeCheck(),this.checkTimer.reset()}return!0},t.prototype.checkHanlder=function(t){this.removeCheck(),this.lRequest=new G(this.model),this.lRequest.addEventListener(U.LOADCMP,this.checkActDataCmp,this),this.lRequest.load(),this.log("开始请求直播状态接口")},t.prototype.removeCheck=function(){this.lRequest&&(this.lRequest.removeEventListener(U.LOADCMP,this.cheActDataCmp,this),this.lRequest.unload(),this.lRequest=null)},t.prototype.checkActDataCmp=function(t){switch(this.log("直播状态接口返回"+t.args[1][0]),t.args[1][0]+""){case"2":this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_INFO,[{code:3,message:E[t.args[1][0]]}])),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_INTERRUPT,{code:t.args[1][0]}));break;case"3":this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_INFO,[{code:7,message:E[t.args[1][0]]}])),this.facade.dispatchEvent(new A(B.EVENT,B.VIDEO_LIVESTOP,{code:t.args[1][0]}))}this.model.videoSetting.activityStatus=t.args[1][0]},t.prototype.resumeByInterrupt=function(){this.videoplugin.startGslb(0)},t}(),vt=function(){function t(t){this.minVer=t}return t.prototype={setUp:function(t,e){var i="http://sdk.lecloud.com/live.swf";r.isHttps()&&(i="https://s.yuntv.letv.com/blives.swf"),this.id=c.create(e,{url:i,version:this.minVer},this.flashvarsToString(t)),this.plugin=c.getPlayer(this.id),this.api=new ut(this)},flashvarsToString:function(t){var e,i="";for(e in t)i+=e+"="+t[e]+"&";return i}},t}(),Et=function(){function e(t){this.init(t)}return e.prototype={init:function(t){switch(this.check(t)){case"swf":this.player=new vt(10);break;default:this.player=new mt}},setUp:function(t,e,i){this.player.setUp.apply(this.player,arguments)},check:function(e){return e.hasOwnProperty("type")?e.type:e.hasOwnProperty("dbd")&&"LETV"==e.dbd?"h5":"android"!=r.getOs()&&"iphone"!=r.getDevice()&&"ipad"!=r.getDevice()&&c.check(10)?"swf":t.createElement("video").canPlayType?"h5":"swf"}},e}(),wt=function(){function t(){}return u.inherits(t,L),t.prototype.init=function(t,e){t.hasOwnProperty("activeid")&&(t.activityId=t.activeid,delete t.activeid);var i="100%",o="100%",s="player"+r.creatUuid();t.hasOwnProperty("width")&&(isNaN(t.width)?-1!=i.indexOf("%")&&(i=t.width):i=t.width+"px"),t.hasOwnProperty("height")&&(isNaN(t.height)?-1!=o.indexOf("%")&&(o=t.height):o=t.height+"px"),i='<div id="#{player}" style="position: relative;width: {width};height:{height};overflow: hidden;margin-right:auto;margin-left:auto"></div>'.replace(/{width}/g,i),i=i.replace(/{height}/g,o),i=i.replace(/#{player}/g,s),"string"==typeof e&&""!=e&&l.$E(e)?l.$E(e).innerHTML=i:S.write(i),o=ct,i=new Et(t),i.setUp(t,s,e),this.sdk=new o(i.player)},t}();w.CloudLivePlayer=wt,w.leCloudLiveplayer=function(t){return{setup:function(e){(new CloudLivePlayer).init(e,t)}}}}(document,void 0);